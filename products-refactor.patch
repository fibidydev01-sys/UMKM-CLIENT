From 01d46a610253b547ca97ca93133124bcdfd54030 Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Sat, 17 Jan 2026 04:52:28 +0000
Subject: [PATCH] refactor: optimize products list with minimal view + drawer
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

MAJOR PERFORMANCE IMPROVEMENT - Reduce memory usage and prevent crashes

Problem:
- Products list loaded ALL data: images, prices, stock, etc
- Heavy load caused performance issues and potential crashes
- Users requested minimal list view

Solution:
âœ… Created ProductPreviewDrawer component (400+ lines)
   - Shows full product details in drawer on click
   - Image gallery with thumbnails
   - All product info: price, stock, category, etc
   - Edit/Delete/Toggle actions integrated

âœ… Refactored products-table-columns.tsx:
   - MINIMAL VIEW: Name + SKU + Date only (was 7 columns!)
   - Removed: Image, Category, Price, Stock, Status columns
   - Click any row â†’ opens drawer with full details
   - ~160 lines reduced

âœ… Updated products-table.tsx:
   - Integrated ProductPreviewDrawer
   - Row click handler
   - Drawer state management
   - Actions (edit/delete/toggle) via drawer

âœ… Fixed duplicate getInitials export:
   - Updated format.ts to handle null values
   - Removed duplicate from discover/utils.ts
   - Re-export from discover for convenience

Benefits:
ğŸš€ Faster initial render - no image loading in list
ğŸš€ Reduced memory usage - minimal data per row
ğŸš€ Better UX - clean list, details on demand
ğŸš€ No crashes - lightweight list view
ğŸš€ Mobile-friendly drawer for details

Technical:
- TypeScript: âœ… No errors
- Pattern: Same as TenantPreviewDrawer (discover)
- Drawer: Vaul library (consistent with app)
- Responsive: Mobile-optimized

Files changed:
- src/components/products/product-preview-drawer.tsx (NEW, 400+ lines)
- src/components/products/products-table-columns.tsx (MINIMAL)
- src/components/products/products-table.tsx (DRAWER INTEGRATION)
- src/components/products/index.ts (EXPORT DRAWER)
- src/lib/discover/utils.ts (REMOVE DUPLICATE)
- src/lib/format.ts (NULL HANDLING)
---
 src/components/products/index.ts              |   7 +-
 .../products/product-preview-drawer.tsx       | 424 ++++++++++++++++++
 .../products/products-table-columns.tsx       | 197 ++------
 src/components/products/products-table.tsx    |  45 +-
 src/lib/discover/utils.ts                     |  23 +-
 src/lib/format.ts                             |   3 +-
 6 files changed, 507 insertions(+), 192 deletions(-)
 create mode 100644 src/components/products/product-preview-drawer.tsx

diff --git a/src/components/products/index.ts b/src/components/products/index.ts
index ae8317c..2cc7b78 100644
--- a/src/components/products/index.ts
+++ b/src/components/products/index.ts
@@ -1,9 +1,10 @@
-// ==========================================
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 // PRODUCTS COMPONENTS INDEX
-// ==========================================
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 
 export { ProductsTable } from './products-table';
 export { getProductColumns } from './products-table-columns';
 export { ProductsTableToolbar } from './products-table-toolbar';
 export { ProductForm } from './product-form';
-export { ProductDeleteDialog } from './product-delete-dialog';
\ No newline at end of file
+export { ProductDeleteDialog } from './product-delete-dialog';
+export { ProductPreviewDrawer } from './product-preview-drawer';
diff --git a/src/components/products/product-preview-drawer.tsx b/src/components/products/product-preview-drawer.tsx
new file mode 100644
index 0000000..878cf72
--- /dev/null
+++ b/src/components/products/product-preview-drawer.tsx
@@ -0,0 +1,424 @@
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// PRODUCT PREVIEW DRAWER
+// Shows product details in drawer when clicked from list
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
+'use client';
+
+import { useState, useCallback, useRef, useEffect } from 'react';
+import Image from 'next/image';
+import { Drawer } from 'vaul';
+import * as VisuallyHidden from '@radix-ui/react-visually-hidden';
+import {
+  Package,
+  Tag,
+  DollarSign,
+  Box,
+  BarChart3,
+  Calendar,
+  Edit,
+  Trash2,
+  Eye,
+  EyeOff,
+  X,
+  ImageIcon,
+} from 'lucide-react';
+import { Button } from '@/components/ui/button';
+import { Badge } from '@/components/ui/badge';
+import { Separator } from '@/components/ui/separator';
+import { cn } from '@/lib/cn';
+import { formatPrice, formatDateShort } from '@/lib/format';
+import type { Product } from '@/types';
+
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// TYPES
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
+interface ProductPreviewDrawerProps {
+  product: Product | null;
+  open: boolean;
+  onOpenChange: (open: boolean) => void;
+  onEdit?: (product: Product) => void;
+  onDelete?: (product: Product) => void;
+  onToggleActive?: (product: Product) => void;
+}
+
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// MAIN COMPONENT
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
+export function ProductPreviewDrawer({
+  product,
+  open,
+  onOpenChange,
+  onEdit,
+  onDelete,
+  onToggleActive,
+}: ProductPreviewDrawerProps) {
+  const [isHeaderSticky, setIsHeaderSticky] = useState(false);
+  const [selectedImageIndex, setSelectedImageIndex] = useState(0);
+  const scrollContainerRef = useRef<HTMLDivElement>(null);
+  const headerSentinelRef = useRef<HTMLDivElement>(null);
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // SCROLL TO TOP when product changes
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  useEffect(() => {
+    if (open && scrollContainerRef.current) {
+      scrollContainerRef.current.scrollTop = 0;
+      setSelectedImageIndex(0);
+    }
+  }, [product?.id, open]);
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // STICKY HEADER DETECTION
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  useEffect(() => {
+    const scrollContainer = scrollContainerRef.current;
+    const sentinel = headerSentinelRef.current;
+
+    if (!scrollContainer || !sentinel) return;
+
+    const observer = new IntersectionObserver(
+      ([entry]) => {
+        setIsHeaderSticky(!entry.isIntersecting);
+      },
+      {
+        root: scrollContainer,
+        threshold: 0,
+        rootMargin: '-1px 0px 0px 0px',
+      }
+    );
+
+    observer.observe(sentinel);
+    return () => observer.disconnect();
+  }, [open]);
+
+  // Reset states when drawer closes
+  useEffect(() => {
+    if (!open) {
+      setIsHeaderSticky(false);
+      setSelectedImageIndex(0);
+    }
+  }, [open]);
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // HANDLERS
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
+  const handleEdit = useCallback(() => {
+    if (product && onEdit) {
+      onEdit(product);
+      onOpenChange(false);
+    }
+  }, [product, onEdit, onOpenChange]);
+
+  const handleDelete = useCallback(() => {
+    if (product && onDelete) {
+      onDelete(product);
+      onOpenChange(false);
+    }
+  }, [product, onDelete, onOpenChange]);
+
+  const handleToggleActive = useCallback(() => {
+    if (product && onToggleActive) {
+      onToggleActive(product);
+    }
+  }, [product, onToggleActive]);
+
+  if (!product) return null;
+
+  const hasImages = product.images && product.images.length > 0;
+  const currentImage = hasImages ? product.images[selectedImageIndex] : null;
+  const stock = product.stock ?? 0;
+  const minStock = product.minStock ?? 5;
+  const isLowStock = product.trackStock && stock <= minStock;
+
+  return (
+    <Drawer.Root open={open} onOpenChange={onOpenChange}>
+      <Drawer.Portal>
+        {/* Overlay */}
+        <Drawer.Overlay className="fixed inset-0 bg-black/60 z-[9999]" />
+
+        {/* Content */}
+        <Drawer.Content
+          className={cn(
+            'fixed bottom-0 left-0 right-0 z-[10000]',
+            'bg-background rounded-t-[20px]',
+            'max-h-[92vh] outline-none',
+            'flex flex-col'
+          )}
+          aria-describedby="drawer-description"
+        >
+          {/* Accessibility */}
+          <Drawer.Title asChild>
+            <VisuallyHidden.Root>
+              {product.name ? `Preview ${product.name}` : 'Preview Produk'}
+            </VisuallyHidden.Root>
+          </Drawer.Title>
+          <Drawer.Description asChild>
+            <VisuallyHidden.Root id="drawer-description">
+              {product.description || `Lihat detail produk ${product.name || ''}`}
+            </VisuallyHidden.Root>
+          </Drawer.Description>
+
+          {/* Drag Handle */}
+          <div className="flex justify-center pt-3 pb-2 shrink-0">
+            <div className="w-10 h-1 rounded-full bg-muted-foreground/30" />
+          </div>
+
+          {/* Sticky Header */}
+          <div
+            className={cn(
+              'px-4 pb-4 border-b shrink-0 transition-shadow duration-200',
+              'sticky top-0 bg-background z-10',
+              isHeaderSticky && 'shadow-md'
+            )}
+          >
+            <div className="flex items-center justify-between min-w-0">
+              <div className="min-w-0 flex-1">
+                <h2 className="font-semibold text-base truncate">{product.name}</h2>
+                <div className="flex items-center gap-2 text-sm text-muted-foreground mt-1">
+                  {product.sku && <span>SKU: {product.sku}</span>}
+                  {product.category && (
+                    <>
+                      <span>Â·</span>
+                      <span>{product.category}</span>
+                    </>
+                  )}
+                </div>
+              </div>
+              <div className="flex items-center gap-2 ml-4">
+                <Badge variant={product.isActive ? 'default' : 'secondary'}>
+                  {product.isActive ? 'Aktif' : 'Nonaktif'}
+                </Badge>
+              </div>
+            </div>
+          </div>
+
+          {/* Scrollable Content */}
+          <div ref={scrollContainerRef} className="flex-1 overflow-y-auto">
+            {/* Sentinel for sticky detection */}
+            <div ref={headerSentinelRef} className="h-0" />
+
+            {/* Product Images */}
+            <div className="px-4 py-6">
+              <div className="relative w-full max-w-2xl mx-auto">
+                {/* Main Image */}
+                <div className="relative w-full aspect-square rounded-xl overflow-hidden bg-muted">
+                  {currentImage ? (
+                    <Image
+                      src={currentImage}
+                      alt={product.name}
+                      fill
+                      className="object-cover"
+                      priority
+                    />
+                  ) : (
+                    <div className="absolute inset-0 flex flex-col items-center justify-center">
+                      <ImageIcon className="h-16 w-16 text-muted-foreground/30" />
+                      <p className="text-sm text-muted-foreground mt-2">
+                        Tidak ada gambar
+                      </p>
+                    </div>
+                  )}
+                </div>
+
+                {/* Thumbnails */}
+                {hasImages && product.images.length > 1 && (
+                  <div className="grid grid-cols-4 gap-2 mt-3">
+                    {product.images.map((img, idx) => (
+                      <button
+                        key={idx}
+                        onClick={() => setSelectedImageIndex(idx)}
+                        className={cn(
+                          'relative aspect-square rounded-lg overflow-hidden bg-muted',
+                          'border-2 transition-all',
+                          selectedImageIndex === idx
+                            ? 'border-primary'
+                            : 'border-transparent hover:border-muted-foreground/20'
+                        )}
+                      >
+                        <Image
+                          src={img}
+                          alt={`${product.name} ${idx + 1}`}
+                          fill
+                          className="object-cover"
+                        />
+                      </button>
+                    ))}
+                  </div>
+                )}
+              </div>
+            </div>
+
+            {/* Content Area */}
+            <div className="px-4 pb-8 max-w-2xl mx-auto">
+              {/* Price Section */}
+              <div className="mb-6">
+                <h3 className="text-sm font-medium text-muted-foreground mb-2">
+                  Harga
+                </h3>
+                <div className="flex items-baseline gap-3">
+                  <span className="text-2xl font-bold">
+                    {formatPrice(product.price)}
+                  </span>
+                  {product.comparePrice && product.comparePrice > product.price && (
+                    <span className="text-sm text-muted-foreground line-through">
+                      {formatPrice(product.comparePrice)}
+                    </span>
+                  )}
+                </div>
+              </div>
+
+              <Separator className="my-6" />
+
+              {/* Description */}
+              {product.description && (
+                <div className="mb-6">
+                  <h3 className="text-sm font-medium text-muted-foreground mb-2">
+                    Deskripsi
+                  </h3>
+                  <p className="text-sm leading-relaxed">{product.description}</p>
+                </div>
+              )}
+
+              {/* Details Grid */}
+              <div className="grid grid-cols-2 gap-4 mb-6">
+                {/* Category */}
+                {product.category && (
+                  <div className="flex items-start gap-3">
+                    <Tag className="h-4 w-4 text-muted-foreground mt-0.5" />
+                    <div>
+                      <p className="text-xs text-muted-foreground">Kategori</p>
+                      <p className="text-sm font-medium">{product.category}</p>
+                    </div>
+                  </div>
+                )}
+
+                {/* SKU */}
+                {product.sku && (
+                  <div className="flex items-start gap-3">
+                    <Package className="h-4 w-4 text-muted-foreground mt-0.5" />
+                    <div>
+                      <p className="text-xs text-muted-foreground">SKU</p>
+                      <p className="text-sm font-medium font-mono">{product.sku}</p>
+                    </div>
+                  </div>
+                )}
+
+                {/* Stock */}
+                {product.trackStock && (
+                  <div className="flex items-start gap-3">
+                    <Box className="h-4 w-4 text-muted-foreground mt-0.5" />
+                    <div>
+                      <p className="text-xs text-muted-foreground">Stok</p>
+                      <p
+                        className={cn(
+                          'text-sm font-medium',
+                          isLowStock && 'text-orange-500'
+                        )}
+                      >
+                        {stock} {product.unit || 'pcs'}
+                        {isLowStock && ' (Rendah)'}
+                      </p>
+                    </div>
+                  </div>
+                )}
+
+                {/* Cost Price */}
+                {product.costPrice && (
+                  <div className="flex items-start gap-3">
+                    <DollarSign className="h-4 w-4 text-muted-foreground mt-0.5" />
+                    <div>
+                      <p className="text-xs text-muted-foreground">Harga Modal</p>
+                      <p className="text-sm font-medium">
+                        {formatPrice(product.costPrice)}
+                      </p>
+                    </div>
+                  </div>
+                )}
+
+                {/* Created Date */}
+                <div className="flex items-start gap-3">
+                  <Calendar className="h-4 w-4 text-muted-foreground mt-0.5" />
+                  <div>
+                    <p className="text-xs text-muted-foreground">Dibuat</p>
+                    <p className="text-sm font-medium">
+                      {formatDateShort(product.createdAt)}
+                    </p>
+                  </div>
+                </div>
+
+                {/* Featured Badge */}
+                {product.isFeatured && (
+                  <div className="flex items-start gap-3">
+                    <BarChart3 className="h-4 w-4 text-muted-foreground mt-0.5" />
+                    <div>
+                      <p className="text-xs text-muted-foreground">Status</p>
+                      <Badge variant="secondary" className="mt-1">
+                        Unggulan
+                      </Badge>
+                    </div>
+                  </div>
+                )}
+              </div>
+
+              <Separator className="my-6" />
+
+              {/* Action Buttons */}
+              <div className="grid grid-cols-2 gap-3">
+                {onToggleActive && (
+                  <Button
+                    variant="outline"
+                    className="w-full"
+                    onClick={handleToggleActive}
+                  >
+                    {product.isActive ? (
+                      <>
+                        <EyeOff className="h-4 w-4 mr-2" />
+                        Nonaktifkan
+                      </>
+                    ) : (
+                      <>
+                        <Eye className="h-4 w-4 mr-2" />
+                        Aktifkan
+                      </>
+                    )}
+                  </Button>
+                )}
+
+                {onEdit && (
+                  <Button variant="default" className="w-full" onClick={handleEdit}>
+                    <Edit className="h-4 w-4 mr-2" />
+                    Edit
+                  </Button>
+                )}
+              </div>
+
+              {onDelete && (
+                <Button
+                  variant="outline"
+                  className="w-full mt-3 text-destructive hover:text-destructive"
+                  onClick={handleDelete}
+                >
+                  <Trash2 className="h-4 w-4 mr-2" />
+                  Hapus Produk
+                </Button>
+              )}
+            </div>
+          </div>
+
+          {/* Floating Close Button */}
+          <button
+            onClick={() => onOpenChange(false)}
+            className="absolute top-4 right-4 p-2 rounded-full bg-background/80 backdrop-blur border shadow-sm hover:bg-muted transition-colors z-20"
+            aria-label="Tutup preview"
+          >
+            <X className="h-4 w-4" />
+          </button>
+        </Drawer.Content>
+      </Drawer.Portal>
+    </Drawer.Root>
+  );
+}
diff --git a/src/components/products/products-table-columns.tsx b/src/components/products/products-table-columns.tsx
index c80a316..942747d 100644
--- a/src/components/products/products-table-columns.tsx
+++ b/src/components/products/products-table-columns.tsx
@@ -1,32 +1,30 @@
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// PRODUCTS TABLE COLUMNS - V2.0 MINIMAL VIEW
+// Shows only essential info: Name + SKU + Date
+// Click to open drawer for full details
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
 'use client';
 
 import { ColumnDef } from '@tanstack/react-table';
-import Image from 'next/image';
-import { MoreHorizontal, ArrowUpDown, Package } from 'lucide-react';
+import { ArrowUpDown } from 'lucide-react';
 import { Button } from '@/components/ui/button';
 import { Checkbox } from '@/components/ui/checkbox';
-import { Badge } from '@/components/ui/badge';
-import {
-  DropdownMenu,
-  DropdownMenuContent,
-  DropdownMenuItem,
-  DropdownMenuLabel,
-  DropdownMenuSeparator,
-  DropdownMenuTrigger,
-} from '@/components/ui/dropdown-menu';
-import { formatPrice, formatDateShort } from '@/lib/format';
+import { formatDateShort } from '@/lib/format';
 import type { Product } from '@/types';
 
-// ==========================================
-// PRODUCTS TABLE COLUMNS
-// ==========================================
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// TYPES
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 
 interface ColumnActions {
-  onEdit: (product: Product) => void;
-  onDelete: (product: Product) => void;
-  onToggleActive: (product: Product) => void;
+  onRowClick: (product: Product) => void;
 }
 
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// MINIMAL COLUMNS (Name + SKU + Date only)
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
 export function getProductColumns(actions: ColumnActions): ColumnDef<Product>[] {
   return [
     // Checkbox
@@ -47,13 +45,14 @@ export function getProductColumns(actions: ColumnActions): ColumnDef<Product>[]
           checked={row.getIsSelected()}
           onCheckedChange={(value) => row.toggleSelected(!!value)}
           aria-label="Select row"
+          onClick={(e) => e.stopPropagation()} // Prevent row click
         />
       ),
       enableSorting: false,
       enableHiding: false,
     },
 
-    // Image + Name
+    // Name + SKU (Combined)
     {
       accessorKey: 'name',
       header: ({ column }) => (
@@ -68,115 +67,22 @@ export function getProductColumns(actions: ColumnActions): ColumnDef<Product>[]
       cell: ({ row }) => {
         const product = row.original;
         return (
-          <div className="flex items-center gap-3">
-            <div className="relative h-10 w-10 overflow-hidden rounded-lg bg-muted flex-shrink-0">
-              {product.images?.[0] ? (
-                <Image
-                  src={product.images[0]}
-                  alt={product.name}
-                  fill
-                  className="object-cover"
-                />
-              ) : (
-                <div className="flex h-full items-center justify-center">
-                  <Package className="h-4 w-4 text-muted-foreground" />
-                </div>
-              )}
-            </div>
-            <div className="min-w-0">
-              <p className="font-medium truncate max-w-[200px]">{product.name}</p>
-              {product.sku && (
-                <p className="text-xs text-muted-foreground">SKU: {product.sku}</p>
-              )}
-            </div>
+          <div
+            className="min-w-0 cursor-pointer hover:text-primary transition-colors"
+            onClick={() => actions.onRowClick(product)}
+          >
+            <p className="font-medium truncate">{product.name}</p>
+            {product.sku && (
+              <p className="text-xs text-muted-foreground font-mono">
+                SKU: {product.sku}
+              </p>
+            )}
           </div>
         );
       },
     },
 
-    // Category
-    {
-      accessorKey: 'category',
-      header: 'Kategori',
-      cell: ({ row }) => {
-        const category = row.getValue('category') as string | null;
-        return category ? (
-          <Badge variant="outline">{category}</Badge>
-        ) : (
-          <span className="text-muted-foreground">-</span>
-        );
-      },
-      filterFn: (row, id, value) => {
-        if (!value || value === '') return true;
-        return row.getValue(id) === value;
-      },
-    },
-
-    // Price
-    {
-      accessorKey: 'price',
-      header: ({ column }) => (
-        <Button
-          variant="ghost"
-          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
-        >
-          Harga
-          <ArrowUpDown className="ml-2 h-4 w-4" />
-        </Button>
-      ),
-      cell: ({ row }) => {
-        const price = row.getValue('price') as number;
-        return <span className="font-medium">{formatPrice(price)}</span>;
-      },
-    },
-
-    // Stock
-    {
-      accessorKey: 'stock',
-      header: ({ column }) => (
-        <Button
-          variant="ghost"
-          onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
-        >
-          Stok
-          <ArrowUpDown className="ml-2 h-4 w-4" />
-        </Button>
-      ),
-      cell: ({ row }) => {
-        const product = row.original;
-        if (!product.trackStock) {
-          return <span className="text-muted-foreground">-</span>;
-        }
-        const stock = product.stock ?? 0;
-        const minStock = product.minStock ?? 5;
-        const isLow = stock <= minStock;
-        return (
-          <span className={isLow ? 'text-orange-500 font-medium' : ''}>
-            {stock} {product.unit || 'pcs'}
-          </span>
-        );
-      },
-    },
-
-    // Status
-    {
-      accessorKey: 'isActive',
-      header: 'Status',
-      cell: ({ row }) => {
-        const isActive = row.getValue('isActive') as boolean;
-        return (
-          <Badge variant={isActive ? 'default' : 'secondary'}>
-            {isActive ? 'Aktif' : 'Nonaktif'}
-          </Badge>
-        );
-      },
-      filterFn: (row, id, value) => {
-        if (value === undefined) return true;
-        return row.getValue(id) === value;
-      },
-    },
-
-    // Created At
+    // Created Date
     {
       accessorKey: 'createdAt',
       header: ({ column }) => (
@@ -184,50 +90,21 @@ export function getProductColumns(actions: ColumnActions): ColumnDef<Product>[]
           variant="ghost"
           onClick={() => column.toggleSorting(column.getIsSorted() === 'asc')}
         >
-          Dibuat
+          Tanggal
           <ArrowUpDown className="ml-2 h-4 w-4" />
         </Button>
       ),
       cell: ({ row }) => {
         const date = row.getValue('createdAt') as string;
-        return <span className="text-muted-foreground">{formatDateShort(date)}</span>;
-      },
-    },
-
-    // Actions
-    {
-      id: 'actions',
-      enableHiding: false,
-      cell: ({ row }) => {
-        const product = row.original;
-
         return (
-          <DropdownMenu>
-            <DropdownMenuTrigger asChild>
-              <Button variant="ghost" className="h-8 w-8 p-0">
-                <span className="sr-only">Buka menu</span>
-                <MoreHorizontal className="h-4 w-4" />
-              </Button>
-            </DropdownMenuTrigger>
-            <DropdownMenuContent align="end">
-              <DropdownMenuLabel>Aksi</DropdownMenuLabel>
-              <DropdownMenuItem onClick={() => actions.onEdit(product)}>
-                Edit
-              </DropdownMenuItem>
-              <DropdownMenuItem onClick={() => actions.onToggleActive(product)}>
-                {product.isActive ? 'Nonaktifkan' : 'Aktifkan'}
-              </DropdownMenuItem>
-              <DropdownMenuSeparator />
-              <DropdownMenuItem
-                onClick={() => actions.onDelete(product)}
-                className="text-destructive focus:text-destructive"
-              >
-                Hapus
-              </DropdownMenuItem>
-            </DropdownMenuContent>
-          </DropdownMenu>
+          <span
+            className="text-muted-foreground cursor-pointer"
+            onClick={() => actions.onRowClick(row.original)}
+          >
+            {formatDateShort(date)}
+          </span>
         );
       },
     },
   ];
-}
\ No newline at end of file
+}
diff --git a/src/components/products/products-table.tsx b/src/components/products/products-table.tsx
index b7aadb8..240cae1 100644
--- a/src/components/products/products-table.tsx
+++ b/src/components/products/products-table.tsx
@@ -1,3 +1,8 @@
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+// PRODUCTS TABLE - V2.0 WITH DRAWER
+// Minimal list view + drawer for details
+// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+
 'use client';
 
 import { useState, useCallback, useMemo } from 'react';
@@ -36,6 +41,7 @@ import { AlertTriangle, Loader2 } from 'lucide-react';
 import { getProductColumns } from './products-table-columns';
 import { ProductsTableToolbar } from './products-table-toolbar';
 import { ProductDeleteDialog } from './product-delete-dialog';
+import { ProductPreviewDrawer } from './product-preview-drawer';
 import { productsApi, getErrorMessage } from '@/lib/api';
 import { toast } from '@/providers';
 import type { Product } from '@/types';
@@ -59,6 +65,10 @@ export function ProductsTable({
   const [columnVisibility, setColumnVisibility] = useState<VisibilityState>({});
   const [rowSelection, setRowSelection] = useState({});
 
+  // Drawer state
+  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);
+  const [drawerOpen, setDrawerOpen] = useState(false);
+
   const [deleteProduct, setDeleteProduct] = useState<Product | null>(null);
   const [isDeleting, setIsDeleting] = useState(false);
 
@@ -74,7 +84,17 @@ export function ProductsTable({
     }
   }, [onRefresh, router]);
 
-  // âœ… FIX: Stabilize callbacks with useCallback
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // ROW CLICK HANDLER - Open drawer
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  const onRowClick = useCallback((product: Product) => {
+    setSelectedProduct(product);
+    setDrawerOpen(true);
+  }, []);
+
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // DRAWER ACTIONS
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   const onEdit = useCallback((product: Product) => {
     router.push(`/dashboard/products/${product.id}/edit`);
   }, [router]);
@@ -93,14 +113,13 @@ export function ProductsTable({
     }
   }, [refreshData]);
 
-  // âœ… FIX: Memoize columnActions to prevent recreation
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
+  // COLUMN ACTIONS - Only onRowClick needed
+  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   const columnActions = useMemo(() => ({
-    onEdit,
-    onDelete,
-    onToggleActive,
-  }), [onEdit, onDelete, onToggleActive]);
+    onRowClick,
+  }), [onRowClick]);
 
-  // âœ… FIX: Memoize columns
   const columns = useMemo(
     () => getProductColumns(columnActions),
     [columnActions]
@@ -258,6 +277,16 @@ export function ProductsTable({
         </div>
       </div>
 
+      {/* Product Preview Drawer */}
+      <ProductPreviewDrawer
+        product={selectedProduct}
+        open={drawerOpen}
+        onOpenChange={setDrawerOpen}
+        onEdit={onEdit}
+        onDelete={onDelete}
+        onToggleActive={onToggleActive}
+      />
+
       <ProductDeleteDialog
         product={deleteProduct}
         isOpen={!!deleteProduct}
@@ -301,4 +330,4 @@ export function ProductsTable({
       </AlertDialog>
     </div>
   );
-}
\ No newline at end of file
+}
diff --git a/src/lib/discover/utils.ts b/src/lib/discover/utils.ts
index 3a6bbd3..c4be4ed 100644
--- a/src/lib/discover/utils.ts
+++ b/src/lib/discover/utils.ts
@@ -5,27 +5,10 @@
 
 import { CATEGORY_CONFIG } from '@/config/categories';
 import { Store } from 'lucide-react';
+import { getInitials } from '@/lib/format'; // Use from format.ts
 
-// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-// TEXT HELPERS
-// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-
-/**
- * Get initials from name (max 2 characters)
- * @param name - Full name
- * @returns Initials in uppercase (e.g., "JD" for "John Doe")
- * @example getInitials('Toko Saya') => "TS"
- * @example getInitials(null) => "??"
- */
-export function getInitials(name?: string | null): string {
-  if (!name) return '??';
-  return name
-    .split(' ')
-    .map((word) => word[0])
-    .join('')
-    .toUpperCase()
-    .slice(0, 2);
-}
+// Re-export for convenience
+export { getInitials };
 
 // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 // CATEGORY HELPERS
diff --git a/src/lib/format.ts b/src/lib/format.ts
index 2ac2168..315825f 100644
--- a/src/lib/format.ts
+++ b/src/lib/format.ts
@@ -264,7 +264,8 @@ export function slugify(text: string): string {
  * @returns Initials (max 2 chars)
  * @example getInitials('John Doe') => "JD"
  */
-export function getInitials(name: string): string {
+export function getInitials(name?: string | null): string {
+  if (!name) return '??';
   return name
     .split(' ')
     .map((n) => n[0])
-- 
2.43.0

