================================================================
DISCOVER MODULE - COMPLETE COLLECTION (V2 - ISOLATED)
Generated on: Fri, Jan 16, 2026  4:26:23 PM
Working Directory: /d/PRODUK-LPPM-FINAL/UMKM-MULTI-TENANT/client
================================================================

SCOPE:
- Discover Pages (main + category routing)
- Discover Components (NEW: src/components/discover/)
- Shared Dependencies (UI, lib, config)

================================================================


================================================
FILE: src/app/discover/page.tsx
Lines: 39
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER PAGE - V9.0
// Dribbble-style UMKM Discovery
// ══════════════════════════════════════════════════════════════

import type { Metadata } from 'next';
import { DiscoverPageClient } from './client';

// ══════════════════════════════════════════════════════════════
// METADATA
// ══════════════════════════════════════════════════════════════

export const metadata: Metadata = {
  title: 'Discover UMKM Lokal Indonesia | Fibidy',
  description:
    'Temukan berbagai UMKM lokal Indonesia. Warung makan, salon, laundry, bengkel, dan ribuan usaha lainnya. Semua punya toko online sendiri di Fibidy.',
  keywords: [
    'umkm indonesia',
    'discover umkm',
    'toko online lokal',
    'warung online',
    'jasa lokal',
    'fibidy',
  ],
  openGraph: {
    title: 'Discover UMKM Lokal Indonesia | Fibidy',
    description: 'Temukan berbagai UMKM lokal Indonesia dengan toko online sendiri.',
    type: 'website',
    locale: 'id_ID',
    siteName: 'Fibidy',
  },
};

// ══════════════════════════════════════════════════════════════
// PAGE COMPONENT
// ══════════════════════════════════════════════════════════════

export default function DiscoverPage() {
  return <DiscoverPageClient />;
}


================================================
FILE: src/app/discover/client.tsx
Lines: 470
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER PAGE CLIENT - V11.0 REFACTORED
// Components extracted to separate files
// ══════════════════════════════════════════════════════════════

'use client';

import { useState, useCallback, useEffect } from 'react';
import Link from 'next/link';
import { useSearchParams, useRouter } from 'next/navigation';
import { Store, ArrowRight, AlertCircle, Loader2 } from 'lucide-react';
import { Button } from '@/components/ui/button';
import {
  DiscoverHeader,
  DiscoverHero,
  CategoryFilterBar,
  DiscoverFooter,
  TenantPreviewDrawer,
  TenantCard,
  TenantCardSkeleton,
  SearchResultsHeader,
  NoResults,
} from '@/components/discover';
import type { ShowcaseTenant } from '@/components/discover';
import { CATEGORY_CONFIG } from '@/config/categories';
import { getTenantFullUrl } from '@/lib/store-url';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface TenantSitemapItem {
  slug: string;
  updatedAt: string;
}

interface TenantDetail {
  id: string;
  slug: string;
  name: string;
  category: string;
  description: string | null;
  whatsapp: string | null;
  phone: string | null;
  address: string | null;
  logo: string | null;
  banner: string | null;
  theme?: {
    primaryColor?: string;
  };
  socialLinks?: {
    instagram?: string;
    facebook?: string;
    tiktok?: string;
  };
  _count?: {
    products: number;
  };
}

type SortOption = 'popular' | 'newest' | 'oldest' | 'name_asc' | 'name_desc';
type TabType = 'umkm' | 'produk' | 'jasa';

// ══════════════════════════════════════════════════════════════
// CONSTANTS
// ══════════════════════════════════════════════════════════════

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';
const MAX_TENANTS = 24;
const CACHE_KEY = 'fibidy_discover_tenants';
const CACHE_DURATION = 5 * 60 * 1000;

// ══════════════════════════════════════════════════════════════
// CACHE HELPERS
// ══════════════════════════════════════════════════════════════

interface CacheData {
  tenants: ShowcaseTenant[];
  timestamp: number;
}

function getCachedTenants(): ShowcaseTenant[] | null {
  if (typeof window === 'undefined') return null;
  try {
    const cached = sessionStorage.getItem(CACHE_KEY);
    if (!cached) return null;
    const data: CacheData = JSON.parse(cached);
    if (Date.now() - data.timestamp > CACHE_DURATION) {
      sessionStorage.removeItem(CACHE_KEY);
      return null;
    }
    return data.tenants;
  } catch {
    return null;
  }
}

function setCachedTenants(tenants: ShowcaseTenant[]): void {
  if (typeof window === 'undefined') return;
  try {
    const data: CacheData = { tenants, timestamp: Date.now() };
    sessionStorage.setItem(CACHE_KEY, JSON.stringify(data));
  } catch {
    // Storage full or unavailable
  }
}

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function getCategoryLabel(category: string): string {
  return CATEGORY_CONFIG[category]?.labelShort || category;
}

function getCategoryColor(category: string): string {
  return CATEGORY_CONFIG[category]?.color || '#6b7280';
}

// ══════════════════════════════════════════════════════════════
// MAIN CLIENT COMPONENT
// ══════════════════════════════════════════════════════════════

export function DiscoverPageClient() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const urlSearchQuery = searchParams.get('q') || '';

  // State
  const [tenants, setTenants] = useState<ShowcaseTenant[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [searchQuery, setSearchQuery] = useState(urlSearchQuery);
  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);
  const [selectedColor, setSelectedColor] = useState<string | null>(null);
  const [sortBy, setSortBy] = useState<SortOption>('popular');
  const [activeTab, setActiveTab] = useState<TabType>('umkm');

  // Drawer State
  const [selectedTenant, setSelectedTenant] = useState<ShowcaseTenant | null>(null);
  const [drawerOpen, setDrawerOpen] = useState(false);

  // Sync search query with URL
  useEffect(() => {
    setSearchQuery(urlSearchQuery);
  }, [urlSearchQuery]);

  // ════════════════════════════════════════════════════════════
  // FETCH TENANTS
  // ════════════════════════════════════════════════════════════

  useEffect(() => {
    async function fetchTenants() {
      const cachedTenants = getCachedTenants();
      if (cachedTenants) {
        setTenants(cachedTenants);
        setLoading(false);
        return;
      }

      try {
        setLoading(true);
        setError(null);

        const sitemapRes = await fetch(
          `${API_URL}/sitemap/tenants/paginated?page=1&limit=${MAX_TENANTS}`
        );

        if (!sitemapRes.ok) throw new Error('Failed to fetch tenant list');

        const sitemapData = await sitemapRes.json();
        const tenantSlugs: TenantSitemapItem[] = sitemapData.tenants || [];

        if (tenantSlugs.length === 0) {
          setTenants([]);
          return;
        }

        const tenantDetails = await Promise.all(
          tenantSlugs.map(async (item) => {
            try {
              const detailRes = await fetch(`${API_URL}/tenants/by-slug/${item.slug}`);
              if (!detailRes.ok) return null;
              return await detailRes.json();
            } catch {
              return null;
            }
          })
        );

        const validTenants: ShowcaseTenant[] = tenantDetails
          .filter((t): t is TenantDetail => t !== null && t.id)
          .map((t) => ({
            ...t,
            url: getTenantFullUrl(t.slug),
          }));

        setCachedTenants(validTenants);
        setTenants(validTenants);
      } catch (err) {
        console.error('Error fetching tenants:', err);
        setError('Gagal memuat data toko');
      } finally {
        setLoading(false);
      }
    }

    fetchTenants();
  }, []);

  // ════════════════════════════════════════════════════════════
  // FILTER & SORT TENANTS
  // ════════════════════════════════════════════════════════════

  const filteredTenants = tenants
    .filter((tenant) => {
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        const matchesSearch =
          tenant.name?.toLowerCase().includes(query) ||
          tenant.description?.toLowerCase().includes(query) ||
          tenant.category?.toLowerCase().includes(query) ||
          getCategoryLabel(tenant.category).toLowerCase().includes(query);
        if (!matchesSearch) return false;
      }
      if (selectedCategory && tenant.category !== selectedCategory) return false;
      if (selectedColor) {
        const categoryColor = getCategoryColor(tenant.category);
        if (categoryColor !== selectedColor) return false;
      }
      return true;
    })
    .sort((a, b) => {
      switch (sortBy) {
        case 'newest':
          return -1;
        case 'oldest':
          return 1;
        case 'name_asc':
          return (a.name || '').localeCompare(b.name || '');
        case 'name_desc':
          return (b.name || '').localeCompare(a.name || '');
        case 'popular':
        default:
          return (b._count?.products || 0) - (a._count?.products || 0);
      }
    });

  // ════════════════════════════════════════════════════════════
  // HANDLERS
  // ════════════════════════════════════════════════════════════

  const handleSearch = useCallback(
    (query: string) => {
      setSearchQuery(query);
      if (query) {
        router.push(`/discover?q=${encodeURIComponent(query)}`, { scroll: false });
      } else {
        router.push('/discover', { scroll: false });
      }
    },
    [router]
  );

  const handleClearSearch = useCallback(() => {
    setSearchQuery('');
    router.push('/discover', { scroll: false });
  }, [router]);

  const handleCategorySelect = useCallback((category: string | null) => {
    setSelectedCategory(category);
  }, []);

  const handleColorSelect = useCallback((color: string | null) => {
    setSelectedColor(color);
  }, []);

  const handleSortChange = useCallback((sort: SortOption) => {
    setSortBy(sort);
  }, []);

  const handleTabChange = useCallback((tab: TabType) => {
    setActiveTab(tab);
  }, []);

  const handleCardClick = useCallback((tenant: ShowcaseTenant) => {
    setSelectedTenant(tenant);
    setDrawerOpen(true);
  }, []);

  const handleTenantSelect = useCallback((tenant: ShowcaseTenant) => {
    setSelectedTenant(tenant);
  }, []);

  // ════════════════════════════════════════════════════════════
  // RENDER
  // ════════════════════════════════════════════════════════════

  const isSearchMode = !!searchQuery;
  const hasResults = filteredTenants.length > 0;

  const getFilterDescription = () => {
    const parts: string[] = [];
    if (selectedCategory) parts.push(`Kategori: ${getCategoryLabel(selectedCategory)}`);
    if (selectedColor) parts.push(`Warna: ${selectedColor}`);
    return parts.join(' • ');
  };

  return (
    <div className="flex min-h-screen flex-col bg-background">
      {/* Header */}
      <DiscoverHeader
        onSearch={handleSearch}
        onCategorySelect={handleCategorySelect}
        searchQuery={searchQuery}
        selectedCategory={selectedCategory}
      />

      <main className="flex-1">
        {/* Conditional Hero or Search Results Header */}
        {isSearchMode ? (
          <SearchResultsHeader
            query={searchQuery}
            resultCount={filteredTenants.length}
            onClear={handleClearSearch}
          />
        ) : (
          <DiscoverHero
            onSearch={handleSearch}
            onCategorySelect={handleCategorySelect}
            onTabChange={handleTabChange}
            searchQuery={searchQuery}
            activeTab={activeTab}
          />
        )}

        {/* Filter Bar */}
        <CategoryFilterBar
          selectedCategory={selectedCategory}
          onCategorySelect={handleCategorySelect}
          selectedColor={selectedColor}
          onColorSelect={handleColorSelect}
          sortBy={sortBy}
          onSortChange={handleSortChange}
          isSticky={true}
        />

        {/* Content */}
        <section className="py-8">
          <div className="container mx-auto px-4">
            {/* Stats & Filter Info */}
            {!loading && filteredTenants.length > 0 && (
              <div className="flex flex-wrap items-center gap-2 text-sm text-muted-foreground mb-6">
                <span>{filteredTenants.length} UMKM ditemukan</span>
                {(selectedCategory || selectedColor) && (
                  <>
                    <span>•</span>
                    <span>{getFilterDescription()}</span>
                    <button
                      onClick={() => {
                        handleCategorySelect(null);
                        handleColorSelect(null);
                      }}
                      className="text-primary hover:underline"
                    >
                      Reset Filter
                    </button>
                  </>
                )}
              </div>
            )}

            {/* Loading State */}
            {loading && (
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
                {Array.from({ length: 8 }).map((_, i) => (
                  <TenantCardSkeleton key={i} />
                ))}
              </div>
            )}

            {/* Error State */}
            {error && !loading && (
              <div className="text-center py-20">
                <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mb-4">
                  <AlertCircle className="h-8 w-8 text-destructive" />
                </div>
                <p className="text-muted-foreground mb-4">{error}</p>
                <Button variant="outline" onClick={() => window.location.reload()}>
                  Coba Lagi
                </Button>
              </div>
            )}

            {/* No Results (Search Mode) */}
            {!loading && !error && isSearchMode && !hasResults && (
              <NoResults query={searchQuery} onClear={handleClearSearch} />
            )}

            {/* Empty State (Not Search Mode) */}
            {!loading && !error && !isSearchMode && filteredTenants.length === 0 && (
              <div className="text-center py-20">
                <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4">
                  <Store className="h-8 w-8 text-muted-foreground" />
                </div>
                <h3 className="font-semibold mb-2">
                  {selectedCategory || selectedColor ? 'Tidak ada hasil' : 'Belum ada toko'}
                </h3>
                <p className="text-muted-foreground mb-6">
                  {selectedCategory || selectedColor
                    ? 'Tidak ada UMKM yang cocok dengan filter.'
                    : 'Jadilah yang pertama membuat toko di Fibidy!'}
                </p>
                {selectedCategory || selectedColor ? (
                  <Button
                    variant="outline"
                    onClick={() => {
                      setSelectedCategory(null);
                      setSelectedColor(null);
                    }}
                  >
                    Reset Filter
                  </Button>
                ) : (
                  <Button asChild>
                    <Link href="/register">
                      Buat Toko Sekarang
                      <ArrowRight className="ml-2 h-4 w-4" />
                    </Link>
                  </Button>
                )}
              </div>
            )}

            {/* Tenant Grid */}
            {!loading && !error && filteredTenants.length > 0 && (
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
                {filteredTenants.map((tenant) => (
                  <TenantCard key={tenant.id} tenant={tenant} onClick={handleCardClick} />
                ))}
              </div>
            )}

            {/* Load More */}
            {!loading && !error && filteredTenants.length >= 20 && (
              <div className="text-center mt-12">
                <Button variant="outline" size="lg">
                  <Loader2 className="mr-2 h-4 w-4" />
                  Muat Lebih Banyak
                </Button>
              </div>
            )}
          </div>
        </section>
      </main>

      {/* Footer */}
      <DiscoverFooter />

      {/* Tenant Preview Drawer */}
      <TenantPreviewDrawer
        tenant={selectedTenant}
        open={drawerOpen}
        onOpenChange={setDrawerOpen}
        tenantUrl={selectedTenant?.url || ''}
        allTenants={tenants}
        onTenantSelect={handleTenantSelect}
      />
    </div>
  );
}


================================================
FILE: src/app/discover/[category]/page.tsx
Lines: 101
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER BY CATEGORY PAGE
// Route: /discover/[category]
// Example: /discover/bengkel-motor
// ══════════════════════════════════════════════════════════════

import type { Metadata } from 'next';
import { notFound } from 'next/navigation';
import { CategoryPageClient } from './client';
import { CATEGORY_CONFIG } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface CategoryPageProps {
  params: Promise<{
    category: string;
  }>;
}

// ══════════════════════════════════════════════════════════════
// HELPERS
// ══════════════════════════════════════════════════════════════

// Convert slug to category key: "bengkel-motor" -> "BENGKEL_MOTOR"
function slugToCategoryKey(slug: string): string {
  return slug.toUpperCase().replace(/-/g, '_');
}

// Convert category key to slug: "BENGKEL_MOTOR" -> "bengkel-motor"
function categoryKeyToSlug(key: string): string {
  return key.toLowerCase().replace(/_/g, '-');
}

// Get category config from slug
function getCategoryFromSlug(slug: string) {
  const key = slugToCategoryKey(slug);
  return CATEGORY_CONFIG[key] || null;
}

// ══════════════════════════════════════════════════════════════
// GENERATE STATIC PARAMS (Optional - for SSG)
// ══════════════════════════════════════════════════════════════

export async function generateStaticParams() {
  return Object.keys(CATEGORY_CONFIG).map((key) => ({
    category: categoryKeyToSlug(key),
  }));
}

// ══════════════════════════════════════════════════════════════
// GENERATE METADATA
// ══════════════════════════════════════════════════════════════

export async function generateMetadata({ params }: CategoryPageProps): Promise<Metadata> {
  const { category: categorySlug } = await params;
  const category = getCategoryFromSlug(categorySlug);

  if (!category) {
    return {
      title: 'Kategori Tidak Ditemukan | Fibidy',
    };
  }

  return {
    title: `${category.label} - Discover UMKM | Fibidy`,
    description: `Temukan UMKM ${category.label} di Indonesia. ${category.description}. Lihat daftar ${category.labels.product.toLowerCase()}, harga, dan pesan langsung via WhatsApp.`,
    keywords: [
      category.label.toLowerCase(),
      'umkm',
      category.labels.product.toLowerCase(),
      'toko online',
      'fibidy',
      'indonesia',
    ],
    openGraph: {
      title: `${category.label} - Discover UMKM | Fibidy`,
      description: `Temukan UMKM ${category.label} di Indonesia. ${category.description}.`,
      type: 'website',
      locale: 'id_ID',
      siteName: 'Fibidy',
    },
  };
}

// ══════════════════════════════════════════════════════════════
// PAGE COMPONENT
// ══════════════════════════════════════════════════════════════

export default async function CategoryPage({ params }: CategoryPageProps) {
  const { category: categorySlug } = await params;
  const categoryKey = slugToCategoryKey(categorySlug);
  const category = CATEGORY_CONFIG[categoryKey];

  // 404 if category not found
  if (!category) {
    notFound();
  }

  return <CategoryPageClient categoryKey={categoryKey} categorySlug={categorySlug} />;
}


================================================
FILE: src/app/discover/[category]/client.tsx
Lines: 480
================================================

'use client';

import { useState, useCallback, useEffect } from 'react';
import Link from 'next/link';
import Image from 'next/image';
import { useRouter } from 'next/navigation';
import {
  Store,
  Package,
  ArrowRight,
  AlertCircle,
  Loader2,
  ArrowLeft,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Skeleton } from '@/components/ui/skeleton';
import {
  DiscoverHeader,
  CategoryFilterBar,
  MinimalFooter,
} from '@/components/discover';
import { CATEGORY_CONFIG } from '@/config/categories';
import { getTenantFullUrl } from '@/lib/store-url';
import { cn } from '@/lib/cn';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface TenantSitemapItem {
  slug: string;
  updatedAt: string;
}

interface TenantDetail {
  id: string;
  slug: string;
  name: string;
  category: string;
  description: string | null;
  logo: string | null;
  banner: string | null;
  _count?: {
    products: number;
  };
}

interface ShowcaseTenant extends TenantDetail {
  url: string;
}

type SortOption = 'popular' | 'newest' | 'oldest' | 'name_asc' | 'name_desc';

interface CategoryPageClientProps {
  categoryKey: string;
  categorySlug: string;
}

// ══════════════════════════════════════════════════════════════
// CONSTANTS
// ══════════════════════════════════════════════════════════════

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';
const MAX_TENANTS = 50;

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function getCategoryLabel(category: string): string {
  return CATEGORY_CONFIG[category]?.labelShort || category;
}

function getInitials(name?: string | null): string {
  if (!name) return '??';
  return name
    .split(' ')
    .map((word) => word[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
}

function categoryKeyToSlug(key: string): string {
  return key.toLowerCase().replace(/_/g, '-');
}

// ══════════════════════════════════════════════════════════════
// SKELETON LOADER
// ══════════════════════════════════════════════════════════════

function TenantCardSkeleton() {
  return (
    <div className="group">
      <Skeleton className="aspect-[4/3] w-full rounded-xl" />
      <div className="flex items-center gap-3 mt-3 px-1">
        <Skeleton className="h-8 w-8 rounded-full shrink-0" />
        <div className="flex-1 min-w-0">
          <Skeleton className="h-4 w-3/4" />
        </div>
        <Skeleton className="h-4 w-12" />
      </div>
    </div>
  );
}

// ══════════════════════════════════════════════════════════════
// TENANT CARD - Dribbble Style
// ══════════════════════════════════════════════════════════════

interface TenantCardProps {
  tenant: ShowcaseTenant;
}

function TenantCard({ tenant }: TenantCardProps) {
  const productCount = tenant._count?.products || 0;

  return (
    <Link
      href={tenant.url}
      target="_blank"
      rel="noopener noreferrer"
      className="group block"
    >
      {/* Image Container */}
      <div className="relative aspect-[4/3] w-full rounded-xl overflow-hidden bg-muted">
        {tenant.banner ? (
          <Image
            src={tenant.banner}
            alt={tenant.name || 'Store'}
            fill
            className="object-cover transition-transform duration-500 group-hover:scale-105"
          />
        ) : (
          <div className="absolute inset-0 bg-gradient-to-br from-primary/20 via-primary/10 to-pink-500/20 flex items-center justify-center">
            <Store className="h-12 w-12 text-primary/40" />
          </div>
        )}

        {/* Hover Overlay */}
        <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300">
          <div className="absolute bottom-0 left-0 right-0 p-4 translate-y-2 group-hover:translate-y-0 transition-transform duration-300">
            {tenant.description && (
              <p className="text-white/90 text-sm line-clamp-2 mb-3">
                {tenant.description}
              </p>
            )}
            <div className="flex items-center justify-between">
              <Badge variant="secondary" className="bg-white/20 text-white border-0 text-xs">
                {getCategoryLabel(tenant.category)}
              </Badge>
              <div className="flex items-center gap-1.5 text-white/80 text-sm">
                <Package className="h-3.5 w-3.5" />
                <span>{productCount} produk</span>
              </div>
            </div>
          </div>
        </div>

        {/* Corner Badge */}
        <div className="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
          <div className="bg-white rounded-full p-2 shadow-lg">
            <ArrowRight className="h-4 w-4 text-primary" />
          </div>
        </div>
      </div>

      {/* Footer */}
      <div className="flex items-center gap-3 mt-3 px-1">
        <div className="h-8 w-8 rounded-full bg-muted flex items-center justify-center overflow-hidden shrink-0 ring-2 ring-background">
          {tenant.logo ? (
            <Image
              src={tenant.logo}
              alt={tenant.name || 'Logo'}
              width={32}
              height={32}
              className="object-cover"
            />
          ) : (
            <span className="text-xs font-bold text-muted-foreground">
              {getInitials(tenant.name)}
            </span>
          )}
        </div>
        <h3 className="font-medium text-sm text-foreground truncate flex-1 group-hover:text-primary transition-colors">
          {tenant.name || 'Unnamed Store'}
        </h3>
        <span className="text-xs text-muted-foreground shrink-0">
          {productCount} items
        </span>
      </div>
    </Link>
  );
}

// ══════════════════════════════════════════════════════════════
// CATEGORY HERO
// ══════════════════════════════════════════════════════════════

interface CategoryHeroProps {
  category: typeof CATEGORY_CONFIG[string];
  tenantCount: number;
}

function CategoryHero({ category, tenantCount }: CategoryHeroProps) {
  const Icon = category.icon;

  return (
    <section className="pt-20 pb-8 bg-gradient-to-b from-muted/50 to-background">
      <div className="container mx-auto px-4">
        {/* Back Link */}
        <Link
          href="/discover"
          className="inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6 transition-colors"
        >
          <ArrowLeft className="h-4 w-4" />
          Kembali ke Discover
        </Link>

        {/* Category Info */}
        <div className="flex items-start gap-4">
          <div
            className="w-16 h-16 rounded-2xl flex items-center justify-center shrink-0"
            style={{ backgroundColor: `${category.color}20` }}
          >
            <Icon className="h-8 w-8" style={{ color: category.color }} />
          </div>
          <div>
            <h1 className="text-3xl md:text-4xl font-bold mb-2">{category.label}</h1>
            <p className="text-muted-foreground mb-3">{category.description}</p>
            <div className="flex items-center gap-4 text-sm">
              <span className="text-muted-foreground">
                <strong className="text-foreground">{tenantCount}</strong> UMKM terdaftar
              </span>
              <span className="text-muted-foreground">•</span>
              <span className="text-muted-foreground">
                {category.labels.product}: {category.labels.price}
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}

// ══════════════════════════════════════════════════════════════
// MAIN CLIENT COMPONENT
// ══════════════════════════════════════════════════════════════

export function CategoryPageClient({ categoryKey, categorySlug }: CategoryPageClientProps) {
  const router = useRouter();
  const category = CATEGORY_CONFIG[categoryKey];

  // State
  const [tenants, setTenants] = useState<ShowcaseTenant[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [sortBy, setSortBy] = useState<SortOption>('popular');

  // ════════════════════════════════════════════════════════════
  // FETCH TENANTS
  // ════════════════════════════════════════════════════════════

  useEffect(() => {
    async function fetchTenants() {
      try {
        setLoading(true);
        setError(null);

        const sitemapRes = await fetch(
          `${API_URL}/sitemap/tenants/paginated?page=1&limit=${MAX_TENANTS}`
        );

        if (!sitemapRes.ok) {
          throw new Error('Failed to fetch tenant list');
        }

        const sitemapData = await sitemapRes.json();
        const tenantSlugs: TenantSitemapItem[] = sitemapData.tenants || [];

        if (tenantSlugs.length === 0) {
          setTenants([]);
          return;
        }

        const tenantDetails = await Promise.all(
          tenantSlugs.map(async (item) => {
            try {
              const detailRes = await fetch(`${API_URL}/tenants/by-slug/${item.slug}`);
              if (!detailRes.ok) return null;
              return await detailRes.json();
            } catch {
              return null;
            }
          })
        );

        // Filter by category
        const validTenants: ShowcaseTenant[] = tenantDetails
          .filter((t): t is TenantDetail => t !== null && t.id && t.category === categoryKey)
          .map((t) => ({
            ...t,
            url: getTenantFullUrl(t.slug),
          }));

        setTenants(validTenants);
      } catch (err) {
        console.error('Error fetching tenants:', err);
        setError('Gagal memuat data toko');
      } finally {
        setLoading(false);
      }
    }

    fetchTenants();
  }, [categoryKey]);

  // ════════════════════════════════════════════════════════════
  // FILTER & SORT
  // ════════════════════════════════════════════════════════════

  const filteredTenants = tenants
    .filter((tenant) => {
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        return (
          tenant.name?.toLowerCase().includes(query) ||
          tenant.description?.toLowerCase().includes(query)
        );
      }
      return true;
    })
    .sort((a, b) => {
      switch (sortBy) {
        case 'name_asc':
          return (a.name || '').localeCompare(b.name || '');
        case 'name_desc':
          return (b.name || '').localeCompare(a.name || '');
        case 'popular':
        default:
          return (b._count?.products || 0) - (a._count?.products || 0);
      }
    });

  // ════════════════════════════════════════════════════════════
  // HANDLERS
  // ════════════════════════════════════════════════════════════

  const handleSearch = useCallback((query: string) => {
    setSearchQuery(query);
  }, []);

  const handleCategorySelect = useCallback(
    (newCategory: string | null) => {
      if (newCategory === null) {
        router.push('/discover');
      } else if (newCategory !== categoryKey) {
        router.push(`/discover/${categoryKeyToSlug(newCategory)}`);
      }
    },
    [categoryKey, router]
  );

  const handleSortChange = useCallback((sort: SortOption) => {
    setSortBy(sort);
  }, []);

  // ════════════════════════════════════════════════════════════
  // RENDER
  // ════════════════════════════════════════════════════════════

  return (
    <div className="flex min-h-screen flex-col bg-background">
      {/* Header */}
      <DiscoverHeader
        onSearch={handleSearch}
        onCategorySelect={handleCategorySelect}
        searchQuery={searchQuery}
        selectedCategory={categoryKey}
      />

      <main className="flex-1">
        {/* Category Hero */}
        <CategoryHero category={category} tenantCount={tenants.length} />

        {/* Filter Bar (Sticky) */}
        <CategoryFilterBar
          selectedCategory={categoryKey}
          onCategorySelect={handleCategorySelect}
          sortBy={sortBy}
          onSortChange={handleSortChange}
          isSticky={true}
        />

        {/* Content */}
        <section className="py-8">
          <div className="container mx-auto px-4">
            {/* Loading */}
            {loading && (
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
                {Array.from({ length: 8 }).map((_, i) => (
                  <TenantCardSkeleton key={i} />
                ))}
              </div>
            )}

            {/* Error */}
            {error && !loading && (
              <div className="text-center py-20">
                <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mb-4">
                  <AlertCircle className="h-8 w-8 text-destructive" />
                </div>
                <p className="text-muted-foreground mb-4">{error}</p>
                <Button variant="outline" onClick={() => window.location.reload()}>
                  Coba Lagi
                </Button>
              </div>
            )}

            {/* Empty */}
            {!loading && !error && filteredTenants.length === 0 && (
              <div className="text-center py-20">
                <div
                  className="inline-flex items-center justify-center w-16 h-16 rounded-full mb-4"
                  style={{ backgroundColor: `${category.color}20` }}
                >
                  <category.icon className="h-8 w-8" style={{ color: category.color }} />
                </div>
                <h3 className="font-semibold mb-2">
                  {searchQuery ? 'Tidak ada hasil' : `Belum ada ${category.label}`}
                </h3>
                <p className="text-muted-foreground mb-6">
                  {searchQuery
                    ? `Tidak ditemukan UMKM dengan kata kunci "${searchQuery}"`
                    : `Jadilah ${category.label} pertama di Fibidy!`}
                </p>
                {searchQuery ? (
                  <Button variant="outline" onClick={() => setSearchQuery('')}>
                    Reset Pencarian
                  </Button>
                ) : (
                  <Button asChild>
                    <Link href="/register">
                      Daftar Sekarang
                      <ArrowRight className="ml-2 h-4 w-4" />
                    </Link>
                  </Button>
                )}
              </div>
            )}

            {/* Grid */}
            {!loading && !error && filteredTenants.length > 0 && (
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
                {filteredTenants.map((tenant) => (
                  <TenantCard key={tenant.id} tenant={tenant} />
                ))}
              </div>
            )}

            {/* Load More */}
            {!loading && !error && filteredTenants.length >= 20 && (
              <div className="text-center mt-12">
                <Button variant="outline" size="lg">
                  <Loader2 className="mr-2 h-4 w-4" />
                  Muat Lebih Banyak
                </Button>
              </div>
            )}
          </div>
        </section>
      </main>

      {/* Footer */}
      <MinimalFooter />
    </div>
  );
}


================================================
FILE: src/app/discover/[category]/not-found.tsx
Lines: 24
================================================

import Link from 'next/link';
import { Store, ArrowLeft } from 'lucide-react';
import { Button } from '@/components/ui/button';

export default function CategoryNotFound() {
  return (
    <div className="min-h-screen flex items-center justify-center bg-background">
      <div className="text-center px-4">
        <div className="inline-flex items-center justify-center w-20 h-20 rounded-full bg-muted mb-6">
          <Store className="h-10 w-10 text-muted-foreground" />
        </div>
        <h1 className="text-2xl font-bold mb-2">Kategori Tidak Ditemukan</h1>
        <p className="text-muted-foreground mb-6 max-w-md">
          Kategori yang kamu cari tidak tersedia. Coba lihat kategori lainnya di halaman Discover.
        </p>
        <Button asChild>
          <Link href="/discover">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Kembali ke Discover
          </Link>
        </Button>
      </div>
    </div>
  );
}


================================================
FILE: src/components/discover/index.ts
Lines: 26
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER MODULE - BARREL EXPORTS
// Isolated from platform-landing
// ══════════════════════════════════════════════════════════════

// Layout Components
export { DiscoverHeader } from './discover-header';
export { DiscoverHero } from './discover-hero';
export { DiscoverSearch } from './discover-search';
export { DiscoverFooter } from './discover-footer';
export { MinimalFooter } from './minimal-footer';

// Filter & Navigation
export { CategoryFilterBar } from './category-filter-bar';

// Tenant Components
export { TenantPreviewDrawer } from './tenant-preview-drawer';
export { TenantCard, TenantCardSkeleton } from './tenant-card';
export type { ShowcaseTenant } from './tenant-card';

// Search Components
export { SearchResultsHeader } from './search-results-header';
export { NoResults } from './no-results';

// Showcase Sections
export { UMKMShowcaseSection } from './umkm-showcase-section';
export { UMKMDiscoverSection } from './umkm-discover-section';


================================================
FILE: src/components/discover/discover-header.tsx
Lines: 449
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER HEADER - V10.3
// Fixed: Search ONLY appears when hero search is completely hidden
// Uses IntersectionObserver for accurate detection
// ══════════════════════════════════════════════════════════════

'use client';

import { useState, useEffect, useCallback, useRef } from 'react';
import Link from 'next/link';
import { useRouter } from 'next/navigation';
import { Store, Menu } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Sheet, SheetContent, SheetTrigger, SheetTitle } from '@/components/ui/sheet';
import {
  NavigationMenu,
  NavigationMenuContent,
  NavigationMenuItem,
  NavigationMenuLink,
  NavigationMenuList,
  NavigationMenuTrigger,
} from '@/components/ui/navigation-menu';
import { DiscoverSearch } from './discover-search';
import { cn } from '@/lib/cn';
import { CATEGORY_CONFIG, getCategoryList } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface DiscoverHeaderProps {
  onSearch?: (query: string) => void;
  onCategorySelect?: (category: string | null) => void;
  searchQuery?: string;
  selectedCategory?: string | null;
  /** 
   * ID of the hero search element to observe
   * Header search will only show when this element is NOT visible
   */
  heroSearchId?: string;
}

// ══════════════════════════════════════════════════════════════
// STATIC NAV DATA
// ══════════════════════════════════════════════════════════════

const moreItems = [
  { label: 'Tentang', href: '/about', description: 'Pelajari lebih lanjut tentang Fibidy' },
  { label: 'Fitur', href: '/fitur', description: 'Semua fitur untuk produk & jasa' },
  { label: 'Cara Kerja', href: '/cara-kerja', description: 'Gampang banget, 5 menit jadi' },
  { label: 'Harga', href: '/harga', description: 'Mulai dari Rp 0, tanpa biaya tersembunyi' },
];

const quickLinks = [
  { label: 'FAQ', href: '/faq' },
  { label: 'Kontak', href: '/contact' },
  { label: 'Privasi', href: '/privacy' },
];

function categoryKeyToSlug(key: string): string {
  return key.toLowerCase().replace(/_/g, '-');
}

// ══════════════════════════════════════════════════════════════
// COMPONENT
// ══════════════════════════════════════════════════════════════

export function DiscoverHeader({
  onSearch,
  onCategorySelect,
  searchQuery = '',
  selectedCategory = null,
  heroSearchId = 'hero-search', // Default ID to look for
}: DiscoverHeaderProps) {
  const router = useRouter();
  const [isScrolled, setIsScrolled] = useState(false);
  const [heroSearchVisible, setHeroSearchVisible] = useState(true);
  const [isOpen, setIsOpen] = useState(false);

  const categories = getCategoryList();

  // Header search should ONLY show when:
  // 1. User has scrolled (for styling)
  // 2. Hero search is NOT visible (completely out of viewport)
  const showHeaderSearch = isScrolled && !heroSearchVisible;

  // ════════════════════════════════════════════════════════════
  // INTERSECTION OBSERVER - Detect when hero search is visible
  // ════════════════════════════════════════════════════════════

  useEffect(() => {
    // Find the hero search element
    const heroSearchElement = document.getElementById(heroSearchId);

    if (!heroSearchElement) {
      // If no hero search element found, always show header search when scrolled
      setHeroSearchVisible(false);
      return;
    }

    // Create observer that triggers when element leaves viewport
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          // Hero search is visible if ANY part is in viewport
          // Header search shows when hero is COMPLETELY out of view
          setHeroSearchVisible(entry.isIntersecting);
        });
      },
      {
        // Root is viewport
        root: null,
        // Trigger when element starts to leave (0 = any part visible)
        threshold: 0,
        // Account for fixed header height (64px)
        rootMargin: '-64px 0px 0px 0px',
      }
    );

    observer.observe(heroSearchElement);

    return () => {
      observer.disconnect();
    };
  }, [heroSearchId]);

  // ════════════════════════════════════════════════════════════
  // SCROLL DETECTION (for header background styling)
  // ════════════════════════════════════════════════════════════

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50);
    };

    // Set initial value
    handleScroll();

    window.addEventListener('scroll', handleScroll, { passive: true });
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // ════════════════════════════════════════════════════════════
  // HANDLERS
  // ════════════════════════════════════════════════════════════

  const handleCategorySelect = useCallback(
    (categoryKey: string | null) => {
      onCategorySelect?.(categoryKey);
      if (categoryKey) {
        router.push(`/discover/${categoryKeyToSlug(categoryKey)}`, { scroll: false });
      } else {
        router.push('/discover', { scroll: false });
      }
    },
    [onCategorySelect, router]
  );

  return (
    <header
      className={cn(
        'fixed top-0 left-0 right-0 transition-all duration-300',
        'z-50',
        isScrolled
          ? 'bg-background/95 backdrop-blur-lg shadow-sm border-b h-16'
          : 'bg-background/80 backdrop-blur-sm h-16'
      )}
    >
      <div className="container mx-auto px-4 h-full">
        <div className="flex items-center justify-between h-full gap-4">
          {/* ══════════════════════════════════════════════════ */}
          {/* LOGO                                               */}
          {/* ══════════════════════════════════════════════════ */}
          <Link href="/" className="flex items-center gap-2 shrink-0">
            <div className="flex h-9 w-9 items-center justify-center rounded-xl bg-primary">
              <Store className="h-5 w-5 text-primary-foreground" />
            </div>
            <span
              className={cn(
                'font-bold text-xl transition-all duration-300',
                showHeaderSearch ? 'hidden lg:block' : 'block'
              )}
            >
              Fibidy
            </span>
          </Link>

          {/* ══════════════════════════════════════════════════ */}
          {/* SEARCH BAR                                         */}
          {/* Only visible when hero search is OUT OF VIEW       */}
          {/* ══════════════════════════════════════════════════ */}
          <div
            className={cn(
              'flex-1 max-w-md transition-all duration-300 hidden md:block',
              showHeaderSearch
                ? 'opacity-100 translate-y-0 pointer-events-auto'
                : 'opacity-0 -translate-y-2 pointer-events-none'
            )}
          >
            <DiscoverSearch
              size="default"
              placeholder="Cari UMKM..."
              defaultValue={searchQuery}
              onSearch={onSearch}
              showSuggestions={true}
            />
          </div>

          {/* ══════════════════════════════════════════════════ */}
          {/* DESKTOP NAVIGATION                                 */}
          {/* ══════════════════════════════════════════════════ */}
          <NavigationMenu className="hidden md:flex">
            <NavigationMenuList>
              {/* EXPLORE DROPDOWN */}
              <NavigationMenuItem>
                <NavigationMenuTrigger>Explore</NavigationMenuTrigger>
                <NavigationMenuContent>
                  <div className="w-[500px] lg:w-[600px] p-4">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="text-sm font-semibold text-muted-foreground">
                        Kategori UMKM
                      </h3>
                      <Link
                        href="/discover"
                        className="text-xs text-primary hover:underline"
                      >
                        Lihat Semua
                      </Link>
                    </div>

                    <div className="grid grid-cols-3 gap-2">
                      {categories.slice(0, 12).map((cat) => {
                        const Icon = cat.icon;
                        return (
                          <NavigationMenuLink asChild key={cat.key}>
                            <Link
                              href={`/discover/${categoryKeyToSlug(cat.key)}`}
                              className={cn(
                                'flex items-center gap-3 p-3 rounded-lg',
                                'hover:bg-accent transition-colors',
                                'group'
                              )}
                            >
                              <div
                                className="w-9 h-9 rounded-lg flex items-center justify-center shrink-0 transition-transform group-hover:scale-110"
                                style={{ backgroundColor: `${cat.color}15` }}
                              >
                                <Icon
                                  className="h-4 w-4"
                                  style={{ color: cat.color }}
                                />
                              </div>
                              <div className="min-w-0">
                                <p className="text-sm font-medium truncate">
                                  {cat.labelShort}
                                </p>
                              </div>
                            </Link>
                          </NavigationMenuLink>
                        );
                      })}
                    </div>

                    {categories.length > 12 && (
                      <div className="mt-4 pt-4 border-t text-center">
                        <Link
                          href="/discover"
                          className="text-sm text-primary hover:underline"
                        >
                          +{categories.length - 12} kategori lainnya
                        </Link>
                      </div>
                    )}
                  </div>
                </NavigationMenuContent>
              </NavigationMenuItem>

              {/* LAINNYA DROPDOWN */}
              <NavigationMenuItem>
                <NavigationMenuTrigger>Lainnya</NavigationMenuTrigger>
                <NavigationMenuContent>
                  <div className="w-[400px] p-4">
                    <div className="grid gap-2">
                      {moreItems.map((item) => (
                        <NavigationMenuLink asChild key={item.href}>
                          <Link
                            href={item.href}
                            className="block p-3 rounded-lg hover:bg-accent transition-colors"
                          >
                            <p className="text-sm font-medium">{item.label}</p>
                            <p className="text-xs text-muted-foreground mt-0.5">
                              {item.description}
                            </p>
                          </Link>
                        </NavigationMenuLink>
                      ))}
                    </div>

                    <div className="mt-4 pt-4 border-t flex flex-wrap gap-3">
                      {quickLinks.map((link) => (
                        <NavigationMenuLink asChild key={link.href}>
                          <Link
                            href={link.href}
                            className="text-xs text-muted-foreground hover:text-foreground transition-colors"
                          >
                            {link.label}
                          </Link>
                        </NavigationMenuLink>
                      ))}
                    </div>
                  </div>
                </NavigationMenuContent>
              </NavigationMenuItem>
            </NavigationMenuList>
          </NavigationMenu>

          {/* ══════════════════════════════════════════════════ */}
          {/* CTA BUTTONS                                        */}
          {/* ══════════════════════════════════════════════════ */}
          <div className="hidden md:flex items-center gap-2">
            <Button variant="ghost" size="sm" asChild>
              <Link href="/login">Masuk</Link>
            </Button>
            <Button size="sm" asChild className="rounded-full px-4">
              <Link href="/register">Buat Toko</Link>
            </Button>
          </div>

          {/* ══════════════════════════════════════════════════ */}
          {/* MOBILE MENU                                        */}
          {/* ══════════════════════════════════════════════════ */}
          <Sheet open={isOpen} onOpenChange={setIsOpen}>
            <SheetTrigger asChild className="md:hidden">
              <Button variant="ghost" size="icon">
                <Menu className="h-5 w-5" />
              </Button>
            </SheetTrigger>
            <SheetContent side="right" className="w-80 overflow-y-auto">
              <SheetTitle className="sr-only">Menu Navigasi</SheetTitle>

              {/* Mobile Logo */}
              <div className="flex items-center gap-2 mb-6">
                <div className="flex h-9 w-9 items-center justify-center rounded-xl bg-primary">
                  <Store className="h-5 w-5 text-primary-foreground" />
                </div>
                <span className="font-bold text-xl">Fibidy</span>
              </div>

              {/* Mobile Search */}
              <div className="mb-6">
                <DiscoverSearch
                  size="default"
                  placeholder="Cari UMKM..."
                  defaultValue={searchQuery}
                  onSearch={(q) => {
                    onSearch?.(q);
                    setIsOpen(false);
                  }}
                  showSuggestions={false}
                />
              </div>

              <nav className="flex flex-col gap-1">
                {/* Kategori Section */}
                <p className="text-sm font-semibold text-muted-foreground mb-2 px-3">
                  Explore Kategori
                </p>

                {/* All Categories */}
                <button
                  onClick={() => {
                    handleCategorySelect(null);
                    setIsOpen(false);
                  }}
                  className={cn(
                    'flex items-center gap-3 px-3 py-2.5 rounded-md text-left transition-colors',
                    !selectedCategory
                      ? 'bg-primary/10 text-primary font-medium'
                      : 'hover:bg-accent'
                  )}
                >
                  <Store className="h-4 w-4" />
                  <span>Semua Kategori</span>
                </button>

                {/* Category List */}
                <div className="max-h-64 overflow-y-auto space-y-0.5 mt-1">
                  {categories.map((cat) => {
                    const Icon = cat.icon;
                    return (
                      <button
                        key={cat.key}
                        onClick={() => {
                          handleCategorySelect(cat.key);
                          setIsOpen(false);
                        }}
                        className={cn(
                          'flex items-center gap-3 px-3 py-2.5 rounded-md w-full text-left transition-colors',
                          selectedCategory === cat.key
                            ? 'bg-primary/10 text-primary font-medium'
                            : 'hover:bg-accent'
                        )}
                      >
                        <Icon
                          className="h-4 w-4 shrink-0"
                          style={{ color: cat.color }}
                        />
                        <span className="truncate">{cat.label}</span>
                      </button>
                    );
                  })}
                </div>

                {/* Lainnya Section */}
                <div className="border-t my-4" />
                <p className="text-sm font-semibold text-muted-foreground mb-2 px-3">
                  Lainnya
                </p>
                {moreItems.map((item) => (
                  <Link
                    key={item.href}
                    href={item.href}
                    onClick={() => setIsOpen(false)}
                    className="block px-3 py-2.5 rounded-md hover:bg-accent transition-colors"
                  >
                    {item.label}
                  </Link>
                ))}

                {/* Mobile CTA */}
                <div className="flex flex-col gap-2 mt-6 pt-4 border-t">
                  <Button variant="outline" asChild className="w-full">
                    <Link href="/login" onClick={() => setIsOpen(false)}>
                      Masuk
                    </Link>
                  </Button>
                  <Button asChild className="w-full">
                    <Link href="/register" onClick={() => setIsOpen(false)}>
                      Buat Toko
                    </Link>
                  </Button>
                </div>
              </nav>
            </SheetContent>
          </Sheet>
        </div>
      </div>
    </header>
  );
}


================================================
FILE: src/components/discover/discover-hero.tsx
Lines: 286
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER HERO - V10.8 FINAL
// Feature: Tabs filter Popular tags (4 categories per type)
// ══════════════════════════════════════════════════════════════

'use client';

import { useCallback, useMemo } from 'react';
import Link from 'next/link';
import {
  Store,
  Package,
  Wrench,
  Sparkles,
  ArrowRight,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { DiscoverSearch } from './discover-search';
import { cn } from '@/lib/cn';
import { CATEGORY_CONFIG } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

type TabType = 'umkm' | 'produk' | 'jasa';

interface DiscoverHeroProps {
  onSearch?: (query: string) => void;
  onCategorySelect?: (category: string | null) => void;
  onTabChange?: (tab: TabType) => void;
  searchQuery?: string;
  activeTab?: TabType;
}

// ══════════════════════════════════════════════════════════════
// DATA - Category mapping by type (4 each)
// ══════════════════════════════════════════════════════════════

const tabs = [
  { id: 'umkm' as TabType, label: 'UMKM', icon: Store, description: 'Toko & Usaha' },
  { id: 'produk' as TabType, label: 'Produk', icon: Package, description: 'Barang & Item' },
  { id: 'jasa' as TabType, label: 'Jasa', icon: Wrench, description: 'Layanan & Service' },
];

// Mapping kategori berdasarkan tipe (4 per tipe)
const CATEGORIES_BY_TYPE: Record<TabType, string[]> = {
  // UMKM - Toko & Usaha fisik
  umkm: [
    'WARUNG_KELONTONG',  // Warung
    'TOKO_BANGUNAN',     // Bangunan
    'KEDAI_KOPI',        // Kopi
    'APOTEK',            // Apotek
  ],
  // Produk - Barang yang dijual
  produk: [
    'TOKO_KUE',          // Kue
    'PETSHOP',           // Pet
    'PERCETAKAN',        // Print
    'TOKO_BANGUNAN',     // Bangunan (material)
  ],
  // Jasa - Layanan & Service
  jasa: [
    'BENGKEL_MOTOR',     // Bengkel
    'SALON_BARBERSHOP',  // Salon
    'LAUNDRY',           // Laundry
    'CATERING',          // Catering
  ],
};

// Placeholder text per tab
const SEARCH_PLACEHOLDERS: Record<TabType, string> = {
  umkm: 'Cari warung, toko, kedai...',
  produk: 'Cari makanan, kue, produk...',
  jasa: 'Cari bengkel, salon, laundry...',
};

function categoryKeyToSlug(key: string): string {
  return key.toLowerCase().replace(/_/g, '-');
}

// ══════════════════════════════════════════════════════════════
// COMPONENT
// ══════════════════════════════════════════════════════════════

export function DiscoverHero({
  onSearch,
  onCategorySelect,
  onTabChange,
  searchQuery = '',
  activeTab = 'umkm',
}: DiscoverHeroProps) {

  // Get categories based on active tab
  const popularCategories = useMemo(() => {
    return CATEGORIES_BY_TYPE[activeTab] || CATEGORIES_BY_TYPE.umkm;
  }, [activeTab]);

  const handleTabClick = useCallback((tabId: TabType) => {
    onTabChange?.(tabId);
  }, [onTabChange]);

  return (
    <section className="relative pt-20 pb-8">
      {/* Background */}
      <div className="absolute inset-0 bg-gradient-to-b from-muted/50 via-background to-background -z-10" />

      {/* Decorative Elements */}
      <div className="absolute top-20 right-0 w-[500px] h-[500px] opacity-50 pointer-events-none hidden lg:block -z-10">
        <div className="relative w-full h-full">
          <div className="absolute inset-0 bg-gradient-to-br from-primary/10 via-pink-500/10 to-purple-500/10 rounded-3xl blur-3xl" />
        </div>
      </div>

      <div className="container mx-auto px-4">
        <div className="grid lg:grid-cols-2 gap-8 lg:gap-12 items-center">

          {/* LEFT CONTENT */}
          <div className="max-w-xl">
            {/* Headline */}
            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight mb-4">
              Discover
              <br />
              <span className="text-primary">UMKM Lokal</span>
            </h1>

            {/* Subheadline */}
            <p className="text-lg md:text-xl text-muted-foreground mb-8 leading-relaxed">
              Temukan berbagai usaha lokal Indonesia. Warung, salon, bengkel,
              dan ribuan UMKM lainnya.
            </p>

            {/* ══════════════════════════════════════════════════ */}
            {/* TABS - Click to filter categories                  */}
            {/* ══════════════════════════════════════════════════ */}
            <div className="flex items-center gap-2 mb-6">
              {tabs.map((tab) => {
                const Icon = tab.icon;
                const isActive = activeTab === tab.id;
                return (
                  <button
                    key={tab.id}
                    onClick={() => handleTabClick(tab.id)}
                    className={cn(
                      'flex items-center gap-2 px-4 py-2.5 rounded-full text-sm font-medium transition-all duration-200',
                      isActive
                        ? 'bg-foreground text-background shadow-lg'
                        : 'bg-muted hover:bg-muted/80 text-muted-foreground hover:text-foreground'
                    )}
                  >
                    <Icon className="h-4 w-4" />
                    <span>{tab.label}</span>
                  </button>
                );
              })}
            </div>

            {/* Search Bar */}
            <div id="hero-search" className="mb-4 relative z-40">
              <DiscoverSearch
                size="hero"
                placeholder={SEARCH_PLACEHOLDERS[activeTab]}
                defaultValue={searchQuery}
                onSearch={onSearch}
                showSuggestions={true}
              />
            </div>

            {/* ══════════════════════════════════════════════════ */}
            {/* POPULAR TAGS - Dynamic based on active tab (4)     */}
            {/* ══════════════════════════════════════════════════ */}
            <div className="flex flex-wrap items-center gap-2 relative z-10">
              <span className="text-sm text-muted-foreground">Popular:</span>
              {popularCategories.map((catKey) => {
                const category = CATEGORY_CONFIG[catKey];
                if (!category) return null;
                return (
                  <Link
                    key={catKey}
                    href={`/discover/${categoryKeyToSlug(catKey)}`}
                    className={cn(
                      'px-3 py-1.5 text-sm rounded-full border',
                      'bg-background hover:bg-muted hover:border-primary/50',
                      'transition-colors duration-200',
                      'flex items-center gap-1.5'
                    )}
                  >
                    <span
                      className="w-2 h-2 rounded-full"
                      style={{ backgroundColor: category.color }}
                    />
                    {category.labelShort}
                  </Link>
                );
              })}
            </div>
          </div>

          {/* RIGHT CONTENT - SHOWCASE */}
          <div className="hidden lg:block relative z-0">
            <div className="relative aspect-square max-w-md ml-auto">
              {/* Showcase Cards Preview */}
              <div className="absolute inset-0 grid grid-cols-2 gap-4 p-4">
                {/* Card 1 */}
                <div className="bg-background rounded-2xl shadow-xl border overflow-hidden transform rotate-3 hover:rotate-0 transition-transform duration-300">
                  <div className="aspect-[4/3] bg-gradient-to-br from-primary/20 to-pink-500/20 flex items-center justify-center">
                    <Store className="h-8 w-8 text-primary/50" />
                  </div>
                  <div className="p-3">
                    <div className="h-2 w-20 bg-muted rounded mb-2" />
                    <div className="h-2 w-14 bg-muted/60 rounded" />
                  </div>
                </div>

                {/* Card 2 */}
                <div className="bg-background rounded-2xl shadow-xl border overflow-hidden transform -rotate-2 hover:rotate-0 transition-transform duration-300 mt-8">
                  <div className="aspect-[4/3] bg-gradient-to-br from-blue-500/20 to-cyan-500/20 flex items-center justify-center">
                    <Package className="h-8 w-8 text-blue-500/50" />
                  </div>
                  <div className="p-3">
                    <div className="h-2 w-16 bg-muted rounded mb-2" />
                    <div className="h-2 w-12 bg-muted/60 rounded" />
                  </div>
                </div>

                {/* Card 3 */}
                <div className="bg-background rounded-2xl shadow-xl border overflow-hidden transform -rotate-3 hover:rotate-0 transition-transform duration-300">
                  <div className="aspect-[4/3] bg-gradient-to-br from-orange-500/20 to-amber-500/20 flex items-center justify-center">
                    <Wrench className="h-8 w-8 text-orange-500/50" />
                  </div>
                  <div className="p-3">
                    <div className="h-2 w-18 bg-muted rounded mb-2" />
                    <div className="h-2 w-10 bg-muted/60 rounded" />
                  </div>
                </div>

                {/* Card 4 */}
                <div className="bg-background rounded-2xl shadow-xl border overflow-hidden transform rotate-2 hover:rotate-0 transition-transform duration-300 mt-4">
                  <div className="aspect-[4/3] bg-gradient-to-br from-green-500/20 to-emerald-500/20 flex items-center justify-center">
                    <Store className="h-8 w-8 text-green-500/50" />
                  </div>
                  <div className="p-3">
                    <div className="h-2 w-14 bg-muted rounded mb-2" />
                    <div className="h-2 w-16 bg-muted/60 rounded" />
                  </div>
                </div>
              </div>

              {/* Badge overlay */}
              <div className="absolute -bottom-2 -right-2 bg-background rounded-full px-4 py-2 shadow-lg border flex items-center gap-2 z-[5]">
                <div className="h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center">
                  <Sparkles className="h-4 w-4 text-primary" />
                </div>
                <span className="text-sm font-medium">Discover</span>
              </div>
            </div>
          </div>
        </div>

        {/* CTA BANNER */}
        <div className="mt-8 p-4 rounded-2xl bg-gradient-to-r from-muted/80 to-muted/40 border flex flex-col sm:flex-row items-center justify-between gap-4 relative z-10">
          <div className="flex items-center gap-3">
            <div className="h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0">
              <Sparkles className="h-5 w-5 text-primary" />
            </div>
            <div>
              <p className="font-medium text-sm">
                <Badge variant="secondary" className="mr-2 text-xs">BARU</Badge>
                Punya UMKM?
              </p>
              <p className="text-sm text-muted-foreground">
                Daftarkan usahamu dan tampil di sini. Gratis!
              </p>
            </div>
          </div>
          <Button asChild size="sm" className="shrink-0 rounded-full gap-1">
            <Link href="/register">
              Buat Toko
              <ArrowRight className="h-4 w-4" />
            </Link>
          </Button>
        </div>
      </div>
    </section>
  );
}


================================================
FILE: src/components/discover/discover-search.tsx
Lines: 536
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER SEARCH - V10.9.1 SUBTLE
// Hover: ONLY soft glow border, NO animation/scale
// ══════════════════════════════════════════════════════════════

'use client';

import { useState, useCallback, useRef, useEffect, useMemo } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import {
  Search,
  X,
  TrendingUp,
  Clock,
  ArrowRight,
  Store,
  type LucideIcon,
} from 'lucide-react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { cn } from '@/lib/cn';
import { CATEGORY_CONFIG, getCategoryList } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface SearchSuggestion {
  type: 'category' | 'trending' | 'recent';
  label: string;
  value: string;
  icon?: LucideIcon;
  color?: string;
  slug?: string;
}

interface DiscoverSearchProps {
  placeholder?: string;
  size?: 'default' | 'lg' | 'hero';
  autoFocus?: boolean;
  showSuggestions?: boolean;
  onSearch?: (query: string) => void;
  defaultValue?: string;
  className?: string;
}

// ══════════════════════════════════════════════════════════════
// CONSTANTS
// ══════════════════════════════════════════════════════════════

const TRENDING_SEARCHES: SearchSuggestion[] = [
  { type: 'trending', label: 'Warung Makan', value: 'warung makan' },
  { type: 'trending', label: 'Laundry Kiloan', value: 'laundry kiloan' },
  { type: 'trending', label: 'Bengkel Motor', value: 'bengkel motor' },
  { type: 'trending', label: 'Salon Kecantikan', value: 'salon kecantikan' },
  { type: 'trending', label: 'Catering', value: 'catering' },
];

const RECENT_SEARCHES_KEY = 'fibidy_recent_searches';
const MAX_RECENT_SEARCHES = 5;

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function categoryKeyToSlug(key: string): string {
  return key.toLowerCase().replace(/_/g, '-');
}

function getRecentSearches(): string[] {
  if (typeof window === 'undefined') return [];
  try {
    const stored = localStorage.getItem(RECENT_SEARCHES_KEY);
    return stored ? JSON.parse(stored) : [];
  } catch {
    return [];
  }
}

function saveRecentSearch(query: string): void {
  if (typeof window === 'undefined' || !query.trim()) return;
  try {
    const recent = getRecentSearches();
    const filtered = recent.filter((s) => s.toLowerCase() !== query.toLowerCase());
    const updated = [query, ...filtered].slice(0, MAX_RECENT_SEARCHES);
    localStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(updated));
  } catch {
    // Ignore
  }
}

function clearRecentSearches(): void {
  if (typeof window === 'undefined') return;
  try {
    localStorage.removeItem(RECENT_SEARCHES_KEY);
  } catch {
    // Ignore
  }
}

// ══════════════════════════════════════════════════════════════
// COMPONENT
// ══════════════════════════════════════════════════════════════

export function DiscoverSearch({
  placeholder = 'Cari UMKM, produk, atau jasa...',
  size = 'default',
  autoFocus = false,
  showSuggestions = true,
  onSearch,
  defaultValue = '',
  className,
}: DiscoverSearchProps) {
  const router = useRouter();
  const inputRef = useRef<HTMLInputElement>(null);
  const containerRef = useRef<HTMLDivElement>(null);

  const [query, setQuery] = useState(defaultValue);
  const [isFocused, setIsFocused] = useState(false);
  const [isHovered, setIsHovered] = useState(false);
  const [recentSearches, setRecentSearches] = useState<string[]>([]);
  const [selectedIndex, setSelectedIndex] = useState(-1);

  const categories = useMemo(() => getCategoryList(), []);

  useEffect(() => {
    setRecentSearches(getRecentSearches());
  }, []);

  useEffect(() => {
    function handleClickOutside(event: MouseEvent) {
      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {
        setIsFocused(false);
      }
    }
    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  const suggestions = useMemo((): SearchSuggestion[] => {
    const result: SearchSuggestion[] = [];
    const queryLower = query.toLowerCase().trim();

    if (queryLower) {
      const matchingCategories = categories
        .filter(
          (cat) =>
            cat.label.toLowerCase().includes(queryLower) ||
            cat.labelShort.toLowerCase().includes(queryLower)
        )
        .slice(0, 4)
        .map((cat): SearchSuggestion => ({
          type: 'category',
          label: cat.label,
          value: cat.label,
          icon: cat.icon,
          color: cat.color,
          slug: categoryKeyToSlug(cat.key),
        }));

      result.push(...matchingCategories);

      if (!matchingCategories.some((c) => c.label.toLowerCase() === queryLower)) {
        result.push({
          type: 'trending',
          label: `Cari "${query}"`,
          value: query,
        });
      }
    } else {
      const recentSuggestions: SearchSuggestion[] = recentSearches.slice(0, 3).map((s) => ({
        type: 'recent',
        label: s,
        value: s,
      }));

      if (recentSuggestions.length > 0) {
        result.push(...recentSuggestions);
      }

      result.push(...TRENDING_SEARCHES.slice(0, 5 - recentSuggestions.length));

      const popularCategories = categories.slice(0, 4).map((cat): SearchSuggestion => ({
        type: 'category',
        label: cat.label,
        value: cat.label,
        icon: cat.icon,
        color: cat.color,
        slug: categoryKeyToSlug(cat.key),
      }));

      result.push(...popularCategories);
    }

    return result;
  }, [query, categories, recentSearches]);

  const handleSearch = useCallback(
    (searchQuery: string) => {
      const trimmed = searchQuery.trim();
      if (!trimmed) return;

      saveRecentSearch(trimmed);
      setRecentSearches(getRecentSearches());
      setIsFocused(false);

      onSearch?.(trimmed);
      router.push(`/discover?q=${encodeURIComponent(trimmed)}`);
    },
    [onSearch, router]
  );

  const handleCategoryClick = useCallback(
    (slug: string) => {
      setIsFocused(false);
      router.push(`/discover/${slug}`);
    },
    [router]
  );

  const handleSuggestionClick = useCallback(
    (suggestion: SearchSuggestion) => {
      if (suggestion.type === 'category' && suggestion.slug) {
        handleCategoryClick(suggestion.slug);
      } else {
        setQuery(suggestion.value);
        handleSearch(suggestion.value);
      }
    },
    [handleCategoryClick, handleSearch]
  );

  const handleSubmit = useCallback(
    (e: React.FormEvent) => {
      e.preventDefault();
      if (selectedIndex >= 0 && suggestions[selectedIndex]) {
        handleSuggestionClick(suggestions[selectedIndex]);
      } else {
        handleSearch(query);
      }
    },
    [handleSearch, handleSuggestionClick, query, selectedIndex, suggestions]
  );

  const handleKeyDown = useCallback(
    (e: React.KeyboardEvent) => {
      if (!showSuggestions || !isFocused || suggestions.length === 0) return;

      switch (e.key) {
        case 'ArrowDown':
          e.preventDefault();
          setSelectedIndex((prev) => (prev < suggestions.length - 1 ? prev + 1 : 0));
          break;
        case 'ArrowUp':
          e.preventDefault();
          setSelectedIndex((prev) => (prev > 0 ? prev - 1 : suggestions.length - 1));
          break;
        case 'Escape':
          setIsFocused(false);
          setSelectedIndex(-1);
          break;
      }
    },
    [showSuggestions, isFocused, suggestions.length]
  );

  const handleClearRecent = useCallback(() => {
    clearRecentSearches();
    setRecentSearches([]);
  }, []);

  // ════════════════════════════════════════════════════════════
  // SIZE CLASSES
  // ════════════════════════════════════════════════════════════

  const sizeClasses = {
    default: 'h-10',
    lg: 'h-12',
    hero: 'h-14 text-base',
  };

  const iconSizes = {
    default: 'h-4 w-4',
    lg: 'h-5 w-5',
    hero: 'h-5 w-5',
  };

  const showDropdown = showSuggestions && isFocused && suggestions.length > 0;

  // Active state = hovered OR focused
  const isActive = isHovered || isFocused;

  return (
    <div
      ref={containerRef}
      className={cn('relative', className)}
      style={{ isolation: 'isolate' }}
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      <form onSubmit={handleSubmit}>
        {/* ══════════════════════════════════════════════════════ */}
        {/* SEARCH INPUT WRAPPER - NO animation, just glow        */}
        {/* ══════════════════════════════════════════════════════ */}
        <div className="relative flex items-center">
          {/* ════════════════════════════════════════════════════ */}
          {/* SOFT GLOW - Very subtle, behind input               */}
          {/* ════════════════════════════════════════════════════ */}
          <div
            className={cn(
              'absolute -inset-0.5 rounded-full',
              'bg-primary/15 blur-sm',
              'transition-opacity duration-200',
              isActive ? 'opacity-100' : 'opacity-0'
            )}
          />

          {/* ════════════════════════════════════════════════════ */}
          {/* SEARCH ICON - just color change, no scale           */}
          {/* ════════════════════════════════════════════════════ */}
          <Search
            className={cn(
              'absolute left-4 pointer-events-none z-10',
              'transition-colors duration-200',
              iconSizes[size],
              isActive ? 'text-primary' : 'text-muted-foreground'
            )}
          />

          {/* ════════════════════════════════════════════════════ */}
          {/* INPUT FIELD - subtle border glow only               */}
          {/* ════════════════════════════════════════════════════ */}
          <Input
            ref={inputRef}
            type="text"
            value={query}
            onChange={(e) => {
              setQuery(e.target.value);
              setSelectedIndex(-1);
            }}
            onFocus={() => setIsFocused(true)}
            onKeyDown={handleKeyDown}
            placeholder={placeholder}
            autoFocus={autoFocus}
            autoComplete="off"
            className={cn(
              'relative pl-12 pr-12 rounded-full',
              'transition-all duration-200',
              sizeClasses[size],
              // Default state
              !isActive && 'bg-muted/50 border-transparent',
              // Hover/Focus state - SUBTLE glow only
              isActive && [
                'bg-background',
                'border-primary/25',
                'shadow-sm',
              ]
            )}
          />

          {/* ════════════════════════════════════════════════════ */}
          {/* CLEAR / SUBMIT BUTTON                               */}
          {/* ════════════════════════════════════════════════════ */}
          {query ? (
            <button
              type="button"
              onClick={() => {
                setQuery('');
                inputRef.current?.focus();
              }}
              className="absolute right-4 p-1 rounded-full hover:bg-muted transition-colors z-10"
            >
              <X className={cn('text-muted-foreground', iconSizes[size])} />
            </button>
          ) : (
            <Button
              type="submit"
              size="icon"
              className={cn(
                'absolute right-2 rounded-full z-10',
                size === 'hero' ? 'h-10 w-10' : 'h-8 w-8'
              )}
            >
              <Search className="h-4 w-4" />
            </Button>
          )}
        </div>
      </form>

      {/* ══════════════════════════════════════════════════════ */}
      {/* DROPDOWN                                               */}
      {/* ══════════════════════════════════════════════════════ */}
      {showDropdown && (
        <div
          className={cn(
            'absolute top-full left-0 right-0 mt-2',
            'bg-background rounded-2xl border shadow-xl',
            'overflow-hidden'
          )}
          style={{ zIndex: 99999 }}
        >
          {!query && recentSearches.length > 0 && (
            <div className="flex items-center justify-between px-4 py-2 border-b bg-muted/30">
              <span className="text-xs font-medium text-muted-foreground flex items-center gap-1.5">
                <Clock className="h-3 w-3" />
                Pencarian Terakhir
              </span>
              <button
                onClick={handleClearRecent}
                className="text-xs text-muted-foreground hover:text-foreground transition-colors"
              >
                Hapus Semua
              </button>
            </div>
          )}

          {!query && recentSearches.length === 0 && (
            <div className="px-4 py-2 border-b bg-muted/30">
              <span className="text-xs font-medium text-muted-foreground flex items-center gap-1.5">
                <TrendingUp className="h-3 w-3" />
                Trending
              </span>
            </div>
          )}

          <div className="py-2 max-h-80 overflow-y-auto">
            {suggestions.map((suggestion, index) => {
              const Icon = suggestion.icon || (suggestion.type === 'recent' ? Clock : TrendingUp);
              const isSelected = index === selectedIndex;

              if (
                index > 0 &&
                suggestion.type === 'category' &&
                suggestions[index - 1].type !== 'category'
              ) {
                return (
                  <div key={`header-${index}`}>
                    <div className="px-4 py-2 border-t mt-1">
                      <span className="text-xs font-medium text-muted-foreground flex items-center gap-1.5">
                        <Store className="h-3 w-3" />
                        Kategori
                      </span>
                    </div>
                    <SuggestionItem
                      suggestion={suggestion}
                      Icon={Icon}
                      isSelected={isSelected}
                      onClick={() => handleSuggestionClick(suggestion)}
                    />
                  </div>
                );
              }

              return (
                <SuggestionItem
                  key={`${suggestion.type}-${suggestion.value}-${index}`}
                  suggestion={suggestion}
                  Icon={Icon}
                  isSelected={isSelected}
                  onClick={() => handleSuggestionClick(suggestion)}
                />
              );
            })}
          </div>

          <div className="px-4 py-3 border-t bg-muted/30 flex items-center justify-between">
            <span className="text-xs text-muted-foreground">
              Tekan Enter untuk mencari
            </span>
            <Link
              href="/discover"
              className="text-xs text-primary hover:underline flex items-center gap-1"
            >
              Lihat Semua UMKM
              <ArrowRight className="h-3 w-3" />
            </Link>
          </div>
        </div>
      )}
    </div>
  );
}

// ══════════════════════════════════════════════════════════════
// SUB-COMPONENT - Also subtle, no animation
// ══════════════════════════════════════════════════════════════

interface SuggestionItemProps {
  suggestion: SearchSuggestion;
  Icon: LucideIcon;
  isSelected: boolean;
  onClick: () => void;
}

function SuggestionItem({ suggestion, Icon, isSelected, onClick }: SuggestionItemProps) {
  return (
    <button
      onClick={onClick}
      className={cn(
        'w-full flex items-center gap-3 px-4 py-2.5 text-left',
        'transition-colors duration-150',
        isSelected
          ? 'bg-primary/10 text-primary'
          : 'hover:bg-muted text-foreground'
      )}
    >
      <div
        className={cn(
          'w-8 h-8 rounded-lg flex items-center justify-center shrink-0',
          suggestion.type === 'category' ? 'bg-opacity-20' : 'bg-muted'
        )}
        style={{
          backgroundColor: suggestion.color ? `${suggestion.color}20` : undefined,
        }}
      >
        <Icon
          className="h-4 w-4"
          style={{ color: suggestion.color || 'currentColor' }}
        />
      </div>

      <span className="flex-1 truncate text-sm font-medium">{suggestion.label}</span>

      {suggestion.type === 'category' && (
        <Badge variant="secondary" className="shrink-0 text-xs">
          Kategori
        </Badge>
      )}

      <ArrowRight className="h-4 w-4 text-muted-foreground shrink-0" />
    </button>
  );
}

export default DiscoverSearch;


================================================
FILE: src/components/discover/discover-footer.tsx
Lines: 165
================================================

// ══════════════════════════════════════════════════════════════
// DISCOVER FOOTER - V10.0
// Clean footer untuk Discover pages
// Inspired by modern portfolio/showcase platforms
// ══════════════════════════════════════════════════════════════

import Link from 'next/link';
import { Store } from 'lucide-react';

// ══════════════════════════════════════════════════════════════
// DATA
// ══════════════════════════════════════════════════════════════

const mainNavLinks = [
  { label: 'Untuk UMKM', href: '/about' },
  { label: 'Fitur', href: '/fitur' },
  { label: 'Inspirasi', href: '/discover' },
  { label: 'Harga', href: '/harga' },
  { label: 'Tentang', href: '/about' },
  { label: 'Bantuan', href: '/faq' },
];

const secondaryLinks = [
  { label: 'Warung', href: '/discover/warung-kelontong' },
  { label: 'Bengkel', href: '/discover/bengkel-motor' },
  { label: 'Salon', href: '/discover/salon-barbershop' },
  { label: 'Laundry', href: '/discover/laundry' },
  { label: 'Kopi', href: '/discover/kedai-kopi' },
  { label: 'Catering', href: '/discover/catering' },
];

const legalLinks = [
  { label: 'Syarat', href: '/terms' },
  { label: 'Privasi', href: '/privacy' },
  { label: 'Kontak', href: '/contact' },
];

// Social Icons as SVG components for smaller bundle
function TwitterIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
    </svg>
  );
}

function InstagramIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
    </svg>
  );
}

function TikTokIcon({ className }: { className?: string }) {
  return (
    <svg className={className} viewBox="0 0 24 24" fill="currentColor">
      <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z" />
    </svg>
  );
}

// ══════════════════════════════════════════════════════════════
// COMPONENT
// ══════════════════════════════════════════════════════════════

export function DiscoverFooter() {
  return (
    <footer className="border-t bg-background">
      <div className="container mx-auto px-4">
        {/* ══════════════════════════════════════════════════════ */}
        {/* MAIN ROW - Logo + Nav + Social                        */}
        {/* ══════════════════════════════════════════════════════ */}
        <div className="py-8 flex flex-col lg:flex-row items-center justify-between gap-6">
          {/* Logo */}
          <Link href="/" className="flex items-center gap-2 shrink-0">
            <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary">
              <Store className="h-4 w-4 text-primary-foreground" />
            </div>
            <span className="font-bold text-lg">Fibidy</span>
          </Link>

          {/* Main Navigation */}
          <nav className="flex items-center gap-1 flex-wrap justify-center">
            {mainNavLinks.map((link) => (
              <Link
                key={link.href + link.label}
                href={link.href}
                className="px-3 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors"
              >
                {link.label}
              </Link>
            ))}
          </nav>

          {/* Social Icons */}
          <div className="flex items-center gap-3 shrink-0">
            <a
              href="https://twitter.com/fibidy_id"
              target="_blank"
              rel="noopener noreferrer"
              className="p-2 text-muted-foreground hover:text-foreground transition-colors"
              aria-label="Twitter"
            >
              <TwitterIcon className="h-5 w-5" />
            </a>
            <a
              href="https://instagram.com/fibidy.id"
              target="_blank"
              rel="noopener noreferrer"
              className="p-2 text-muted-foreground hover:text-foreground transition-colors"
              aria-label="Instagram"
            >
              <InstagramIcon className="h-5 w-5" />
            </a>
            <a
              href="https://tiktok.com/@fibidy_id"
              target="_blank"
              rel="noopener noreferrer"
              className="p-2 text-muted-foreground hover:text-foreground transition-colors"
              aria-label="TikTok"
            >
              <TikTokIcon className="h-5 w-5" />
            </a>
          </div>
        </div>

        {/* ══════════════════════════════════════════════════════ */}
        {/* BOTTOM ROW - Copyright + Legal + Categories           */}
        {/* ══════════════════════════════════════════════════════ */}
        <div className="py-6 border-t flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-muted-foreground">
          {/* Copyright + Legal */}
          <div className="flex items-center gap-1 flex-wrap justify-center">
            <span>© {new Date().getFullYear()} Fibidy</span>
            {legalLinks.map((link) => (
              <span key={link.href} className="flex items-center">
                <span className="mx-2">·</span>
                <Link
                  href={link.href}
                  className="hover:text-foreground transition-colors"
                >
                  {link.label}
                </Link>
              </span>
            ))}
          </div>

          {/* Category Quick Links */}
          <div className="flex items-center gap-1 flex-wrap justify-center">
            {secondaryLinks.map((link, index) => (
              <span key={link.href} className="flex items-center">
                {index > 0 && <span className="mx-2">·</span>}
                <Link
                  href={link.href}
                  className="hover:text-foreground transition-colors"
                >
                  {link.label}
                </Link>
              </span>
            ))}
          </div>
        </div>
      </div>
    </footer>
  );
}


================================================
FILE: src/components/discover/category-filter-bar.tsx
Lines: 578
================================================

// ══════════════════════════════════════════════════════════════
// CATEGORY FILTER BAR - V10.7 FINAL
// Fixed: Sticky z-index lowered so search dropdown stays on top
// ══════════════════════════════════════════════════════════════

'use client';

import { useRef, useState, useEffect, useCallback, memo } from 'react';
import {
  ChevronDown,
  SlidersHorizontal,
  ChevronLeft,
  ChevronRight,
  Search,
  X,
  Check,
  TrendingUp,
  Clock,
  History,
  ArrowDownAZ,
  ArrowUpAZ,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from '@/components/ui/popover';
import { Input } from '@/components/ui/input';
import { Badge } from '@/components/ui/badge';
import { cn } from '@/lib/cn';
import { CATEGORY_CONFIG, getCategoryList, type CategoryConfig } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// Z-INDEX HIERARCHY (FINAL V10.7):
// 
// Search Dropdown:          z-[99999]  ← Highest (from discover-search)
// Drawer overlay:           z-[9999]
// Drawer content:           z-[10000]
// Sort/Filter Popover:      z-[200]
// Header (fixed):           z-50
// Filter Bar (sticky):      z-30       ← LOWERED from z-40
// Hero elements:            z-[10]
// ══════════════════════════════════════════════════════════════

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

type SortOption = 'popular' | 'newest' | 'oldest' | 'name_asc' | 'name_desc';

interface CategoryFilterBarProps {
  selectedCategory?: string | null;
  onCategorySelect?: (category: string | null) => void;
  sortBy?: SortOption;
  onSortChange?: (sort: SortOption) => void;
  isSticky?: boolean;
  selectedColor?: string | null;
  onColorSelect?: (color: string | null) => void;
}

// ══════════════════════════════════════════════════════════════
// DATA
// ══════════════════════════════════════════════════════════════

const sortOptions: {
  value: SortOption;
  label: string;
  description: string;
  icon: typeof TrendingUp;
}[] = [
    {
      value: 'popular',
      label: 'Popular',
      description: 'Toko dengan produk terbanyak',
      icon: TrendingUp,
    },
    {
      value: 'newest',
      label: 'Terbaru',
      description: 'Toko yang baru bergabung',
      icon: Clock,
    },
    {
      value: 'oldest',
      label: 'Terlama',
      description: 'Toko yang sudah lama bergabung',
      icon: History,
    },
    {
      value: 'name_asc',
      label: 'Nama A-Z',
      description: 'Urutkan nama dari A ke Z',
      icon: ArrowDownAZ,
    },
    {
      value: 'name_desc',
      label: 'Nama Z-A',
      description: 'Urutkan nama dari Z ke A',
      icon: ArrowUpAZ,
    },
  ];

function getUniqueColors(): { color: string; label: string; categories: string[] }[] {
  const categories = getCategoryList();
  const colorMap = new Map<string, { label: string; categories: string[] }>();

  categories.forEach((cat) => {
    if (!colorMap.has(cat.color)) {
      colorMap.set(cat.color, { label: cat.labelShort, categories: [cat.key] });
    } else {
      colorMap.get(cat.color)!.categories.push(cat.key);
    }
  });

  return Array.from(colorMap.entries()).map(([color, data]) => ({
    color,
    label: data.label,
    categories: data.categories,
  }));
}

// ══════════════════════════════════════════════════════════════
// SORT PANEL
// ══════════════════════════════════════════════════════════════

interface SortPanelProps {
  sortBy: SortOption;
  onSortChange: (sort: SortOption) => void;
  onClose: () => void;
}

const SortPanel = memo(function SortPanel({
  sortBy,
  onSortChange,
  onClose,
}: SortPanelProps) {
  return (
    <div className="w-[280px] p-0">
      <div className="flex items-center justify-between p-3 border-b">
        <h3 className="font-semibold text-sm">Urutkan</h3>
        <button
          onClick={onClose}
          className="text-muted-foreground hover:text-foreground transition-colors"
        >
          <X className="h-4 w-4" />
        </button>
      </div>

      <div className="p-2">
        {sortOptions.map((option) => {
          const Icon = option.icon;
          const isSelected = sortBy === option.value;
          return (
            <button
              key={option.value}
              onClick={() => {
                onSortChange(option.value);
                onClose();
              }}
              className={cn(
                'flex items-start gap-3 w-full p-3 rounded-lg text-left transition-colors',
                isSelected ? 'bg-primary/10' : 'hover:bg-muted'
              )}
            >
              <div
                className={cn(
                  'w-8 h-8 rounded-lg flex items-center justify-center shrink-0',
                  isSelected ? 'bg-primary text-primary-foreground' : 'bg-muted'
                )}
              >
                <Icon className="h-4 w-4" />
              </div>
              <div className="flex-1 min-w-0">
                <p className={cn('text-sm font-medium', isSelected && 'text-primary')}>
                  {option.label}
                </p>
                <p className="text-xs text-muted-foreground mt-0.5">
                  {option.description}
                </p>
              </div>
              {isSelected && <Check className="h-4 w-4 text-primary shrink-0 mt-1" />}
            </button>
          );
        })}
      </div>
    </div>
  );
});

// ══════════════════════════════════════════════════════════════
// FILTER PANEL
// ══════════════════════════════════════════════════════════════

interface FilterPanelProps {
  selectedColor: string | null;
  onColorSelect: (color: string | null) => void;
  tagSearch: string;
  onTagSearchChange: (value: string) => void;
  categories: CategoryConfig[];
  selectedCategory: string | null;
  onCategorySelect: (category: string | null) => void;
  onClose: () => void;
}

const FilterPanel = memo(function FilterPanel({
  selectedColor,
  onColorSelect,
  tagSearch,
  onTagSearchChange,
  categories,
  selectedCategory,
  onCategorySelect,
  onClose,
}: FilterPanelProps) {
  const uniqueColors = getUniqueColors();

  const filteredCategories = categories.filter((cat) =>
    cat.label.toLowerCase().includes(tagSearch.toLowerCase()) ||
    cat.labelShort.toLowerCase().includes(tagSearch.toLowerCase())
  );

  return (
    <div className="w-[500px] lg:w-[600px] p-0">
      <div className="flex items-center justify-between p-4 border-b">
        <h3 className="font-semibold">Filters</h3>
        <button
          onClick={onClose}
          className="text-muted-foreground hover:text-foreground transition-colors"
        >
          <X className="h-4 w-4" />
        </button>
      </div>

      <div className="p-4 grid grid-cols-2 gap-6">
        {/* Tags */}
        <div>
          <label className="text-sm font-medium text-muted-foreground mb-2 block">
            Tags
          </label>
          <div className="relative mb-3">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
            <Input
              placeholder="Search categories..."
              value={tagSearch}
              onChange={(e) => onTagSearchChange(e.target.value)}
              className="pl-9"
            />
          </div>

          {selectedCategory && (
            <div className="mb-3">
              <Badge
                variant="secondary"
                className="gap-1 pr-1"
                style={{
                  backgroundColor: `${CATEGORY_CONFIG[selectedCategory]?.color}15`,
                  color: CATEGORY_CONFIG[selectedCategory]?.color,
                }}
              >
                {CATEGORY_CONFIG[selectedCategory]?.labelShort}
                <button
                  onClick={() => onCategorySelect(null)}
                  className="ml-1 hover:bg-black/10 rounded-full p-0.5"
                >
                  <X className="h-3 w-3" />
                </button>
              </Badge>
            </div>
          )}

          <div className="max-h-48 overflow-y-auto space-y-1">
            {filteredCategories.map((cat) => {
              const Icon = cat.icon;
              const isSelected = selectedCategory === cat.key;
              return (
                <button
                  key={cat.key}
                  onClick={() => onCategorySelect(isSelected ? null : cat.key)}
                  className={cn(
                    'flex items-center gap-2 w-full px-2 py-1.5 rounded text-left text-sm transition-colors',
                    isSelected ? 'bg-primary/10 text-primary font-medium' : 'hover:bg-muted'
                  )}
                >
                  <div
                    className="w-5 h-5 rounded flex items-center justify-center shrink-0"
                    style={{ backgroundColor: `${cat.color}15` }}
                  >
                    <Icon className="h-3 w-3" style={{ color: cat.color }} />
                  </div>
                  <span className="truncate">{cat.labelShort}</span>
                  {isSelected && <Check className="h-3 w-3 ml-auto shrink-0" />}
                </button>
              );
            })}
          </div>
        </div>

        {/* Color */}
        <div>
          <div className="flex items-center justify-between mb-2">
            <label className="text-sm font-medium text-muted-foreground">Color</label>
            {selectedColor && (
              <button onClick={() => onColorSelect(null)} className="text-xs text-primary hover:underline">
                Clear
              </button>
            )}
          </div>

          {selectedColor && (
            <div className="flex items-center gap-2 mb-3 p-2 rounded-lg bg-muted">
              <div
                className="w-5 h-5 rounded-full border-2 border-white shadow-sm"
                style={{ backgroundColor: selectedColor }}
              />
              <span className="text-sm font-mono">{selectedColor}</span>
            </div>
          )}

          <div className="grid grid-cols-5 gap-2">
            {uniqueColors.map(({ color, categories: cats }) => {
              const isSelected = selectedColor === color;
              return (
                <button
                  key={color}
                  onClick={() => onColorSelect(isSelected ? null : color)}
                  className={cn(
                    'group relative aspect-square rounded-lg transition-all',
                    'hover:scale-110 hover:shadow-lg',
                    isSelected && 'ring-2 ring-primary ring-offset-2'
                  )}
                  style={{ backgroundColor: color }}
                  title={`${cats.length} kategori`}
                >
                  {isSelected && (
                    <Check className="absolute inset-0 m-auto h-4 w-4 text-white drop-shadow-md" />
                  )}
                </button>
              );
            })}
          </div>

          <p className="text-xs text-muted-foreground mt-3">
            Pilih warna untuk filter berdasarkan tema kategori.
          </p>
        </div>
      </div>

      <div className="flex items-center justify-between p-4 border-t bg-muted/30">
        <div className="text-sm text-muted-foreground">
          {selectedCategory || selectedColor ? (
            <>
              {selectedCategory && <span className="font-medium">1 kategori</span>}
              {selectedCategory && selectedColor && <span> · </span>}
              {selectedColor && <span className="font-medium">1 warna</span>}
            </>
          ) : (
            'Tidak ada filter aktif'
          )}
        </div>
        <div className="flex gap-2">
          <Button
            variant="ghost"
            size="sm"
            onClick={() => {
              onCategorySelect(null);
              onColorSelect(null);
            }}
          >
            Reset
          </Button>
          <Button size="sm" onClick={onClose}>
            Terapkan
          </Button>
        </div>
      </div>
    </div>
  );
});

// ══════════════════════════════════════════════════════════════
// MAIN COMPONENT
// ══════════════════════════════════════════════════════════════

export function CategoryFilterBar({
  selectedCategory = null,
  onCategorySelect,
  sortBy = 'popular',
  onSortChange,
  isSticky = false,
  selectedColor = null,
  onColorSelect,
}: CategoryFilterBarProps) {
  const scrollContainerRef = useRef<HTMLDivElement>(null);
  const [showLeftArrow, setShowLeftArrow] = useState(false);
  const [showRightArrow, setShowRightArrow] = useState(false);
  const [sortOpen, setSortOpen] = useState(false);
  const [filterOpen, setFilterOpen] = useState(false);
  const [tagSearch, setTagSearch] = useState('');

  const categories = getCategoryList();
  const activeFilterCount = (selectedCategory ? 1 : 0) + (selectedColor ? 1 : 0);
  const currentSortLabel = sortOptions.find(s => s.value === sortBy)?.label || 'Popular';

  // Scroll arrows
  const checkScrollArrows = useCallback(() => {
    const container = scrollContainerRef.current;
    if (!container) return;
    const { scrollLeft, scrollWidth, clientWidth } = container;
    setShowLeftArrow(scrollLeft > 0);
    setShowRightArrow(scrollLeft < scrollWidth - clientWidth - 10);
  }, []);

  useEffect(() => {
    const container = scrollContainerRef.current;
    if (!container) return;
    checkScrollArrows();
    container.addEventListener('scroll', checkScrollArrows, { passive: true });
    window.addEventListener('resize', checkScrollArrows);
    return () => {
      container.removeEventListener('scroll', checkScrollArrows);
      window.removeEventListener('resize', checkScrollArrows);
    };
  }, [checkScrollArrows]);

  const scrollLeft = useCallback(() => {
    scrollContainerRef.current?.scrollBy({ left: -200, behavior: 'smooth' });
  }, []);

  const scrollRight = useCallback(() => {
    scrollContainerRef.current?.scrollBy({ left: 200, behavior: 'smooth' });
  }, []);

  // Handlers
  const handleCategoryClick = useCallback((categoryKey: string | null) => {
    onCategorySelect?.(categoryKey);
  }, [onCategorySelect]);

  const handleSortChange = useCallback((sort: SortOption) => {
    onSortChange?.(sort);
  }, [onSortChange]);

  const handleColorSelect = useCallback((color: string | null) => {
    onColorSelect?.(color);
  }, [onColorSelect]);

  return (
    <div
      className={cn(
        'bg-background border-b transition-all duration-300',
        // ══════════════════════════════════════════════════════
        // z-30: LOWERED from z-40
        // This ensures search dropdown (z-99999) stays on top
        // ══════════════════════════════════════════════════════
        isSticky && 'sticky top-16 z-30 shadow-sm'
      )}
    >
      <div className="container mx-auto px-4">
        <div className="flex items-center gap-2 h-14">

          {/* Sort Popover - z-[200] */}
          <Popover open={sortOpen} onOpenChange={setSortOpen}>
            <PopoverTrigger asChild>
              <Button variant="outline" size="sm" className="gap-1 shrink-0">
                {currentSortLabel}
                <ChevronDown className={cn('h-4 w-4 transition-transform', sortOpen && 'rotate-180')} />
              </Button>
            </PopoverTrigger>
            <PopoverContent
              align="start"
              side="bottom"
              className="p-0 w-auto z-[200]"
              sideOffset={8}
            >
              <SortPanel
                sortBy={sortBy}
                onSortChange={handleSortChange}
                onClose={() => setSortOpen(false)}
              />
            </PopoverContent>
          </Popover>

          {/* Divider */}
          <div className="h-6 w-px bg-border shrink-0" />

          {/* Category Pills */}
          <div className="relative flex-1 flex items-center min-w-0">
            {showLeftArrow && (
              <button
                onClick={scrollLeft}
                className="absolute left-0 z-10 h-8 w-8 flex items-center justify-center bg-gradient-to-r from-background via-background to-transparent"
              >
                <ChevronLeft className="h-4 w-4" />
              </button>
            )}

            <div
              ref={scrollContainerRef}
              className="flex items-center gap-1 overflow-x-auto scrollbar-hide scroll-smooth px-1"
            >
              <button
                onClick={() => handleCategoryClick(null)}
                className={cn(
                  'px-4 py-2 text-sm font-medium rounded-full whitespace-nowrap transition-colors duration-200',
                  !selectedCategory
                    ? 'bg-foreground text-background'
                    : 'text-muted-foreground hover:text-foreground hover:bg-muted'
                )}
              >
                Discover
              </button>

              {categories.map((cat) => (
                <button
                  key={cat.key}
                  onClick={() => handleCategoryClick(cat.key)}
                  className={cn(
                    'flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-full whitespace-nowrap transition-colors duration-200',
                    selectedCategory === cat.key
                      ? 'bg-foreground text-background'
                      : 'text-muted-foreground hover:text-foreground hover:bg-muted'
                  )}
                >
                  <span className="w-2 h-2 rounded-full shrink-0" style={{ backgroundColor: cat.color }} />
                  {cat.labelShort}
                </button>
              ))}
            </div>

            {showRightArrow && (
              <button
                onClick={scrollRight}
                className="absolute right-0 z-10 h-8 w-8 flex items-center justify-center bg-gradient-to-l from-background via-background to-transparent"
              >
                <ChevronRight className="h-4 w-4" />
              </button>
            )}
          </div>

          {/* Filter Popover - z-[200] */}
          <Popover open={filterOpen} onOpenChange={setFilterOpen}>
            <PopoverTrigger asChild>
              <Button
                variant="outline"
                size="sm"
                className={cn('gap-2 shrink-0', activeFilterCount > 0 && 'border-primary')}
              >
                {activeFilterCount > 0 && (
                  <span className="flex h-5 w-5 items-center justify-center rounded-full bg-primary text-primary-foreground text-xs">
                    {activeFilterCount}
                  </span>
                )}
                <SlidersHorizontal className="h-4 w-4" />
                <span className="hidden sm:inline">Filters</span>
              </Button>
            </PopoverTrigger>
            <PopoverContent
              align="end"
              side="bottom"
              className="p-0 w-auto z-[200]"
              sideOffset={8}
            >
              <FilterPanel
                selectedColor={selectedColor}
                onColorSelect={handleColorSelect}
                tagSearch={tagSearch}
                onTagSearchChange={setTagSearch}
                categories={categories}
                selectedCategory={selectedCategory}
                onCategorySelect={handleCategoryClick}
                onClose={() => setFilterOpen(false)}
              />
            </PopoverContent>
          </Popover>
        </div>
      </div>
    </div>
  );
}


================================================
FILE: src/components/discover/tenant-preview-drawer.tsx
Lines: 590
================================================

// ══════════════════════════════════════════════════════════════
// TENANT PREVIEW DRAWER - V10.9 FINAL
// Pattern: Same as DiscoverHero - data managed at page level
// Click tenant in Explore → Switch drawer content (no close)
// ══════════════════════════════════════════════════════════════

'use client';

import { useState, useCallback, useRef, useEffect } from 'react';
import Image from 'next/image';
import Link from 'next/link';
import { Drawer } from 'vaul';
import * as VisuallyHidden from '@radix-ui/react-visually-hidden';
import {
  Store,
  MapPin,
  Package,
  MessageCircle,
  ExternalLink,
  Share2,
  X,
  Instagram,
  Facebook,
  Phone,
  Copy,
  Check,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { cn } from '@/lib/cn';
import { CATEGORY_CONFIG } from '@/config/categories';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface TenantDetail {
  id: string;
  slug: string;
  name: string;
  category: string;
  description: string | null;
  whatsapp: string | null;
  phone: string | null;
  address: string | null;
  logo: string | null;
  banner: string | null;
  theme?: {
    primaryColor?: string;
  };
  socialLinks?: {
    instagram?: string;
    facebook?: string;
    tiktok?: string;
  };
  _count?: {
    products: number;
  };
}

interface TenantPreviewDrawerProps {
  tenant: TenantDetail | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  tenantUrl: string;
  // Data from page (same pattern as DiscoverHero)
  allTenants: TenantDetail[];
  // Callback to switch tenant (drawer stays open)
  onTenantSelect: (tenant: TenantDetail) => void;
}

// ══════════════════════════════════════════════════════════════
// TIKTOK ICON
// ══════════════════════════════════════════════════════════════

function TikTokIcon({ className }: { className?: string }) {
  return (
    <svg
      className={className}
      viewBox="0 0 24 24"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z" />
    </svg>
  );
}

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function getCategoryInfo(category: string) {
  return CATEGORY_CONFIG[category] || {
    label: category,
    labelShort: category,
    color: '#6b7280',
    icon: Store,
  };
}

function getInitials(name?: string | null): string {
  if (!name) return '??';
  return name
    .split(' ')
    .map((word) => word[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
}

function formatWhatsAppUrl(whatsapp: string): string {
  const cleaned = whatsapp.replace(/\D/g, '');
  return `https://wa.me/${cleaned}`;
}

// ══════════════════════════════════════════════════════════════
// EXPLORE TENANT CARD
// ══════════════════════════════════════════════════════════════

interface ExploreTenantCardProps {
  tenant: TenantDetail;
  onClick: () => void;
}

function ExploreTenantCard({ tenant, onClick }: ExploreTenantCardProps) {
  const categoryInfo = getCategoryInfo(tenant.category);
  const primaryColor = tenant.theme?.primaryColor || categoryInfo.color;

  return (
    <button
      onClick={onClick}
      className="group text-left w-full"
    >
      {/* Thumbnail */}
      <div className="relative aspect-[4/3] rounded-xl overflow-hidden bg-muted mb-2">
        {tenant.banner ? (
          <Image
            src={tenant.banner}
            alt={tenant.name}
            fill
            className="object-cover group-hover:scale-105 transition-transform duration-300"
          />
        ) : (
          <div
            className="absolute inset-0 flex items-center justify-center"
            style={{
              background: `linear-gradient(135deg, ${primaryColor}20, ${primaryColor}05)`,
            }}
          >
            <Store className="h-8 w-8 text-muted-foreground/30" />
          </div>
        )}
      </div>

      {/* Info */}
      <div className="flex items-center gap-2">
        {/* Avatar */}
        <div
          className="h-6 w-6 rounded-full flex items-center justify-center overflow-hidden shrink-0 border"
          style={{ borderColor: `${primaryColor}30` }}
        >
          {tenant.logo ? (
            <Image
              src={tenant.logo}
              alt={tenant.name}
              width={24}
              height={24}
              className="object-cover"
            />
          ) : (
            <span
              className="text-[10px] font-bold"
              style={{ color: primaryColor }}
            >
              {getInitials(tenant.name)}
            </span>
          )}
        </div>

        {/* Name */}
        <span className="text-sm font-medium truncate group-hover:text-primary transition-colors">
          {tenant.name}
        </span>
      </div>
    </button>
  );
}

// ══════════════════════════════════════════════════════════════
// MAIN COMPONENT
// ══════════════════════════════════════════════════════════════

export function TenantPreviewDrawer({
  tenant,
  open,
  onOpenChange,
  tenantUrl,
  allTenants = [],  // ← Default empty array to prevent undefined error
  onTenantSelect,
}: TenantPreviewDrawerProps) {
  const [copied, setCopied] = useState(false);
  const [isHeaderSticky, setIsHeaderSticky] = useState(false);
  const scrollContainerRef = useRef<HTMLDivElement>(null);
  const headerSentinelRef = useRef<HTMLDivElement>(null);

  // Filter out current tenant from explore list
  const exploreTenants = allTenants.filter(t => t.id !== tenant?.id);

  // ════════════════════════════════════════════════════════════
  // SCROLL TO TOP when tenant changes
  // ════════════════════════════════════════════════════════════
  useEffect(() => {
    if (open && scrollContainerRef.current) {
      scrollContainerRef.current.scrollTop = 0;
    }
  }, [tenant?.id, open]);

  // ════════════════════════════════════════════════════════════
  // STICKY HEADER DETECTION
  // ════════════════════════════════════════════════════════════
  useEffect(() => {
    const scrollContainer = scrollContainerRef.current;
    const sentinel = headerSentinelRef.current;

    if (!scrollContainer || !sentinel) return;

    const observer = new IntersectionObserver(
      ([entry]) => {
        setIsHeaderSticky(!entry.isIntersecting);
      },
      {
        root: scrollContainer,
        threshold: 0,
        rootMargin: '-1px 0px 0px 0px',
      }
    );

    observer.observe(sentinel);
    return () => observer.disconnect();
  }, [open]);

  // Reset states when drawer closes
  useEffect(() => {
    if (!open) {
      setIsHeaderSticky(false);
      setCopied(false);
    }
  }, [open]);

  // ════════════════════════════════════════════════════════════
  // HANDLERS
  // ════════════════════════════════════════════════════════════

  const handleShare = useCallback(async () => {
    if (!tenant) return;

    const shareData = {
      title: tenant.name || 'UMKM di Fibidy',
      text: tenant.description || `Kunjungi ${tenant.name} di Fibidy`,
      url: tenantUrl,
    };

    try {
      if (navigator.share) {
        await navigator.share(shareData);
      } else {
        await navigator.clipboard.writeText(tenantUrl);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      }
    } catch (err) {
      console.log('Share cancelled or failed');
    }
  }, [tenant, tenantUrl]);

  const handleCopyLink = useCallback(async () => {
    try {
      await navigator.clipboard.writeText(tenantUrl);
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (err) {
      console.error('Failed to copy:', err);
    }
  }, [tenantUrl]);

  // Handle tenant card click - switch tenant, drawer stays open
  const handleTenantClick = useCallback((clickedTenant: TenantDetail) => {
    onTenantSelect(clickedTenant);
    // Scroll to top is handled by useEffect above
  }, [onTenantSelect]);

  if (!tenant) return null;

  const categoryInfo = getCategoryInfo(tenant.category);
  const CategoryIcon = categoryInfo.icon;
  const productCount = tenant._count?.products || 0;
  const primaryColor = tenant.theme?.primaryColor || categoryInfo.color;

  return (
    <Drawer.Root open={open} onOpenChange={onOpenChange}>
      <Drawer.Portal>
        {/* Overlay */}
        <Drawer.Overlay className="fixed inset-0 bg-black/60 z-[9999]" />

        {/* Content */}
        <Drawer.Content
          className={cn(
            'fixed bottom-0 left-0 right-0 z-[10000]',
            'bg-background rounded-t-[20px]',
            'max-h-[92vh] outline-none',
            'flex flex-col'
          )}
          aria-describedby="drawer-description"
        >
          {/* Accessibility */}
          <Drawer.Title asChild>
            <VisuallyHidden.Root>
              {tenant.name ? `Preview ${tenant.name}` : 'Preview Toko UMKM'}
            </VisuallyHidden.Root>
          </Drawer.Title>
          <Drawer.Description asChild>
            <VisuallyHidden.Root id="drawer-description">
              {tenant.description || `Lihat detail toko ${tenant.name || 'UMKM'} di Fibidy`}
            </VisuallyHidden.Root>
          </Drawer.Description>

          {/* Drag Handle */}
          <div className="flex justify-center pt-3 pb-2 shrink-0">
            <div className="w-10 h-1 rounded-full bg-muted-foreground/30" />
          </div>

          {/* Sticky Header */}
          <div
            className={cn(
              'px-4 pb-4 border-b shrink-0 transition-shadow duration-200',
              'sticky top-0 bg-background z-10',
              isHeaderSticky && 'shadow-md'
            )}
          >
            <div className="flex items-center gap-3 min-w-0 pr-10">
              {/* Avatar */}
              <div
                className="h-10 w-10 rounded-full flex items-center justify-center overflow-hidden shrink-0 border"
                style={{ borderColor: `${primaryColor}30` }}
              >
                {tenant.logo ? (
                  <Image
                    src={tenant.logo}
                    alt={tenant.name || 'Logo'}
                    width={40}
                    height={40}
                    className="object-cover"
                  />
                ) : (
                  <span
                    className="text-sm font-bold"
                    style={{ color: primaryColor }}
                  >
                    {getInitials(tenant.name)}
                  </span>
                )}
              </div>

              {/* Name & Category */}
              <div className="min-w-0 flex-1">
                <h2 className="font-semibold text-base truncate">
                  {tenant.name || 'Unnamed Store'}
                </h2>
                <div className="flex items-center gap-2 text-sm text-muted-foreground">
                  <span style={{ color: primaryColor }}>
                    {categoryInfo.labelShort}
                  </span>
                  {tenant.address && (
                    <>
                      <span>·</span>
                      <span className="truncate">{tenant.address.split(',')[0]}</span>
                    </>
                  )}
                </div>
              </div>
            </div>
          </div>

          {/* Scrollable Content */}
          <div ref={scrollContainerRef} className="flex-1 overflow-y-auto">
            {/* Sentinel for sticky detection */}
            <div ref={headerSentinelRef} className="h-0" />

            {/* Banner Image */}
            <div className="px-4 py-6">
              <div className="relative w-full max-w-2xl mx-auto aspect-[16/10] rounded-xl overflow-hidden bg-muted">
                {tenant.banner ? (
                  <Image
                    src={tenant.banner}
                    alt={tenant.name || 'Store Banner'}
                    fill
                    className="object-cover"
                    priority
                  />
                ) : (
                  <div
                    className="absolute inset-0 flex items-center justify-center"
                    style={{
                      background: `linear-gradient(135deg, ${primaryColor}20, ${primaryColor}05)`,
                    }}
                  >
                    <Store className="h-16 w-16 text-muted-foreground/30" />
                  </div>
                )}
              </div>
            </div>

            {/* Content Area */}
            <div className="px-4 pb-8 max-w-2xl mx-auto">
              {/* Stats Row */}
              <div className="flex items-center gap-4 mb-6 text-sm">
                <div className="flex items-center gap-1.5 text-muted-foreground">
                  <Package className="h-4 w-4" />
                  <span><strong className="text-foreground">{productCount}</strong> produk</span>
                </div>
                <Badge
                  variant="secondary"
                  className="gap-1"
                  style={{
                    backgroundColor: `${primaryColor}15`,
                    color: primaryColor,
                  }}
                >
                  <CategoryIcon className="h-3 w-3" />
                  {categoryInfo.labelShort}
                </Badge>
              </div>

              {/* Description */}
              {tenant.description && (
                <div className="mb-6">
                  <p className="text-muted-foreground leading-relaxed">
                    {tenant.description}
                  </p>
                </div>
              )}

              {/* Address */}
              {tenant.address && (
                <div className="flex items-start gap-2 text-sm text-muted-foreground mb-6">
                  <MapPin className="h-4 w-4 shrink-0 mt-0.5" />
                  <span>{tenant.address}</span>
                </div>
              )}

              {/* Social Links */}
              {(tenant.socialLinks?.instagram || tenant.socialLinks?.facebook || tenant.socialLinks?.tiktok || tenant.phone) && (
                <div className="flex items-center gap-2 mb-6">
                  {tenant.socialLinks?.instagram && (
                    <Link
                      href={tenant.socialLinks.instagram}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2.5 rounded-full bg-muted hover:bg-muted/80 transition-colors"
                      aria-label="Instagram"
                    >
                      <Instagram className="h-4 w-4" />
                    </Link>
                  )}
                  {tenant.socialLinks?.tiktok && (
                    <Link
                      href={tenant.socialLinks.tiktok}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2.5 rounded-full bg-muted hover:bg-muted/80 transition-colors"
                      aria-label="TikTok"
                    >
                      <TikTokIcon className="h-4 w-4" />
                    </Link>
                  )}
                  {tenant.socialLinks?.facebook && (
                    <Link
                      href={tenant.socialLinks.facebook}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="p-2.5 rounded-full bg-muted hover:bg-muted/80 transition-colors"
                      aria-label="Facebook"
                    >
                      <Facebook className="h-4 w-4" />
                    </Link>
                  )}
                  {tenant.phone && (
                    <Link
                      href={`tel:${tenant.phone}`}
                      className="p-2.5 rounded-full bg-muted hover:bg-muted/80 transition-colors"
                      aria-label="Telepon"
                    >
                      <Phone className="h-4 w-4" />
                    </Link>
                  )}
                </div>
              )}

              {/* Copy Link */}
              <button
                onClick={handleCopyLink}
                className="w-full flex items-center justify-between p-3 rounded-xl bg-muted/50 hover:bg-muted transition-colors mb-6"
              >
                <span className="text-sm text-muted-foreground truncate">
                  {tenantUrl}
                </span>
                {copied ? (
                  <Check className="h-4 w-4 text-green-500 shrink-0 ml-2" />
                ) : (
                  <Copy className="h-4 w-4 text-muted-foreground shrink-0 ml-2" />
                )}
              </button>

              {/* CTA Buttons */}
              <div className="flex gap-3">
                <Button
                  variant="outline"
                  className="flex-1 h-11 gap-2"
                  onClick={handleShare}
                >
                  <Share2 className="h-4 w-4" />
                  <span>Bagikan</span>
                </Button>

                {tenant.whatsapp && (
                  <Button
                    asChild
                    variant="outline"
                    className="flex-1 h-11 gap-2"
                  >
                    <Link
                      href={formatWhatsAppUrl(tenant.whatsapp)}
                      target="_blank"
                      rel="noopener noreferrer"
                    >
                      <MessageCircle className="h-4 w-4" />
                      <span>WhatsApp</span>
                    </Link>
                  </Button>
                )}

                <Button
                  asChild
                  className="flex-1 h-11 gap-2"
                  style={{ backgroundColor: primaryColor }}
                >
                  <Link
                    href={tenantUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <ExternalLink className="h-4 w-4" />
                    <span>Buka Toko</span>
                  </Link>
                </Button>
              </div>
            </div>

            {/* ══════════════════════════════════════════════════ */}
            {/* EXPLORE LAINNYA                                    */}
            {/* ══════════════════════════════════════════════════ */}
            {exploreTenants.length > 0 && (
              <div className="px-4 pb-8 max-w-2xl mx-auto border-t pt-8">
                <h3 className="text-lg font-semibold mb-4">Explore Lainnya</h3>
                <div className="grid grid-cols-2 sm:grid-cols-3 gap-4">
                  {exploreTenants.map((exploreTenant) => (
                    <ExploreTenantCard
                      key={exploreTenant.id}
                      tenant={exploreTenant}
                      onClick={() => handleTenantClick(exploreTenant)}
                    />
                  ))}
                </div>
              </div>
            )}
          </div>

          {/* Floating Close Button */}
          <button
            onClick={() => onOpenChange(false)}
            className="absolute top-4 right-4 p-2 rounded-full bg-background/80 backdrop-blur border shadow-sm hover:bg-muted transition-colors z-20"
            aria-label="Tutup preview"
          >
            <X className="h-4 w-4" />
          </button>
        </Drawer.Content>
      </Drawer.Portal>
    </Drawer.Root>
  );
}


================================================
FILE: src/components/discover/minimal-footer.tsx
Lines: 65
================================================

import Link from 'next/link';
import { Store } from 'lucide-react';

// ══════════════════════════════════════════════════════════════
// DATA
// ══════════════════════════════════════════════════════════════

const footerLinks = [
  { label: 'Tentang', href: '/about' },
  { label: 'Fitur', href: '/fitur' },
  { label: 'Harga', href: '/harga' },
  { label: 'FAQ', href: '/faq' },
  { label: 'Kontak', href: '/contact' },
  { label: 'Privasi', href: '/privacy' },
  { label: 'Syarat', href: '/terms' },
];

// ══════════════════════════════════════════════════════════════
// COMPONENT
// ══════════════════════════════════════════════════════════════

export function MinimalFooter() {
  return (
    <footer className="border-t bg-background">
      <div className="container mx-auto px-4 py-6">
        <div className="flex flex-col sm:flex-row items-center justify-between gap-4">

          {/* ══════════════════════════════════════════════════ */}
          {/* LEFT: Logo + Copyright                             */}
          {/* ══════════════════════════════════════════════════ */}
          <div className="flex items-center gap-3">
            <Link href="/" className="flex items-center gap-2">
              <div className="flex h-7 w-7 items-center justify-center rounded-lg bg-primary">
                <Store className="h-4 w-4 text-primary-foreground" />
              </div>
              <span className="font-semibold">Fibidy</span>
            </Link>
            <span className="text-muted-foreground">•</span>
            <span className="text-sm text-muted-foreground">
              © {new Date().getFullYear()}
            </span>
          </div>

          {/* ══════════════════════════════════════════════════ */}
          {/* RIGHT: Links                                       */}
          {/* ══════════════════════════════════════════════════ */}
          <nav className="flex items-center gap-1 flex-wrap justify-center">
            {footerLinks.map((link, index) => (
              <span key={link.href} className="flex items-center">
                <Link
                  href={link.href}
                  className="text-sm text-muted-foreground hover:text-foreground transition-colors px-2 py-1"
                >
                  {link.label}
                </Link>
                {index < footerLinks.length - 1 && (
                  <span className="text-muted-foreground/30 hidden sm:inline">•</span>
                )}
              </span>
            ))}
          </nav>
        </div>
      </div>
    </footer>
  );
}


================================================
FILE: src/components/discover/umkm-showcase-section.tsx
Lines: 356
================================================

// ══════════════════════════════════════════════════════════════
// UMKM SHOWCASE SECTION
// Display registered tenants as clickable cards
// Links to subdomain: {slug}.fibidy.com
// ══════════════════════════════════════════════════════════════

'use client';

import { useEffect, useState } from 'react';
import Link from 'next/link';
import Image from 'next/image';
import {
  Store,
  Package,
  ArrowRight,
  AlertCircle,
  ExternalLink,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Card, CardContent } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { getTenantFullUrl } from '@/lib/store-url';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface TenantSitemapItem {
  slug: string;
  updatedAt: string;
}

interface TenantDetail {
  id: string;
  slug: string;
  name: string;
  category: string;
  description: string | null;
  logo: string | null;
  banner: string | null;
  _count?: {
    products: number;
  };
}

interface ShowcaseTenant extends TenantDetail {
  url: string;
}

// ══════════════════════════════════════════════════════════════
// CONSTANTS
// ══════════════════════════════════════════════════════════════

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';
const MAX_TENANTS = 12;

// Category display mapping
const CATEGORY_LABELS: Record<string, string> = {
  'WARUNG_KELONTONG': 'Warung Kelontong',
  'TOKO_BANGUNAN': 'Toko Bangunan',
  'TOKO_ELEKTRONIK': 'Toko Elektronik',
  'BENGKEL': 'Bengkel',
  'SALON_KECANTIKAN': 'Salon Kecantikan',
  'LAUNDRY': 'Laundry',
  'WARUNG_MAKAN': 'Warung Makan',
  'CATERING': 'Catering',
  'KEDAI_KOPI': 'Kedai Kopi',
  'TOKO_KUE': 'Toko Kue & Bakery',
  'APOTEK': 'Apotek',
  'KONTER_HP': 'Konter HP',
  'RENTAL_KENDARAAN': 'Rental',
  'STUDIO_FOTO': 'Studio Foto',
  'PRINTING': 'Printing',
  'PET_SHOP': 'Pet Shop',
  'AC_SERVICE': 'Service AC',
  'RESTORAN': 'Restoran',
  'OTHER': 'Lainnya',
};

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function getCategoryLabel(category: string): string {
  return CATEGORY_LABELS[category] || category;
}

function getInitials(name?: string | null): string {
  if (!name) return '??';
  return name
    .split(' ')
    .map((word) => word[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
}

// ══════════════════════════════════════════════════════════════
// SKELETON LOADER
// ══════════════════════════════════════════════════════════════

function TenantCardSkeleton() {
  return (
    <Card className="overflow-hidden">
      <CardContent className="p-0">
        <Skeleton className="h-24 w-full" />
        <div className="p-4 pt-8 relative">
          <Skeleton className="absolute -top-6 left-4 h-12 w-12 rounded-full" />
          <div className="space-y-2">
            <Skeleton className="h-5 w-3/4" />
            <Skeleton className="h-4 w-1/2" />
            <Skeleton className="h-4 w-full" />
          </div>
        </div>
      </CardContent>
    </Card>
  );
}

// ══════════════════════════════════════════════════════════════
// TENANT CARD COMPONENT
// ══════════════════════════════════════════════════════════════

interface TenantCardProps {
  tenant: ShowcaseTenant;
}

function TenantCard({ tenant }: TenantCardProps) {
  const productCount = tenant._count?.products || 0;

  return (
    <Link
      href={tenant.url}
      target="_blank"
      rel="noopener noreferrer"
      className="group block"
    >
      <Card className="overflow-hidden transition-all duration-300 hover:shadow-lg hover:shadow-primary/10 hover:-translate-y-1 border-2 border-transparent hover:border-primary/20">
        <CardContent className="p-0">
          {/* Banner */}
          <div className="relative h-24 bg-gradient-to-br from-primary/20 via-primary/10 to-pink-500/20 overflow-hidden">
            {tenant.banner ? (
              <Image
                src={tenant.banner}
                alt={`${tenant.name} banner`}
                fill
                className="object-cover transition-transform duration-300 group-hover:scale-105"
              />
            ) : (
              <div className="absolute inset-0 flex items-center justify-center">
                <Store className="h-8 w-8 text-primary/30" />
              </div>
            )}

            {/* External link indicator */}
            <div className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity">
              <div className="bg-background/80 backdrop-blur rounded-full p-1">
                <ExternalLink className="h-3 w-3 text-muted-foreground" />
              </div>
            </div>
          </div>

          {/* Content */}
          <div className="p-4 pt-8 relative">
            {/* Avatar */}
            <div className="absolute -top-6 left-4">
              <div className="h-12 w-12 rounded-full border-4 border-background bg-muted flex items-center justify-center overflow-hidden shadow-md">
                {tenant.logo ? (
                  <Image
                    src={tenant.logo}
                    alt={tenant.name || 'Logo'}
                    width={48}
                    height={48}
                    className="object-cover"
                  />
                ) : (
                  <span className="text-sm font-bold text-muted-foreground">
                    {getInitials(tenant.name)}
                  </span>
                )}
              </div>
            </div>

            {/* Info */}
            <div className="space-y-2">
              <div className="flex items-start justify-between gap-2">
                <h3 className="font-semibold text-sm line-clamp-1 group-hover:text-primary transition-colors">
                  {tenant.name || 'Unnamed Store'}
                </h3>
                <Badge variant="secondary" className="text-xs shrink-0">
                  {getCategoryLabel(tenant.category)}
                </Badge>
              </div>

              {tenant.description && (
                <p className="text-xs text-muted-foreground line-clamp-2">
                  {tenant.description}
                </p>
              )}

              <div className="flex items-center gap-1 text-xs text-muted-foreground">
                <Package className="h-3 w-3" />
                <span>{productCount} produk</span>
              </div>
            </div>
          </div>
        </CardContent>
      </Card>
    </Link>
  );
}

// ══════════════════════════════════════════════════════════════
// MAIN COMPONENT
// ══════════════════════════════════════════════════════════════

export function UMKMShowcaseSection() {
  const [tenants, setTenants] = useState<ShowcaseTenant[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    async function fetchTenants() {
      try {
        setLoading(true);
        setError(null);

        // Step 1: Get tenant slugs from sitemap
        const sitemapRes = await fetch(
          `${API_URL}/sitemap/tenants/paginated?page=1&limit=${MAX_TENANTS}`
        );

        if (!sitemapRes.ok) {
          throw new Error('Failed to fetch tenant list');
        }

        const sitemapData = await sitemapRes.json();
        const tenantSlugs: TenantSitemapItem[] = sitemapData.tenants || [];

        if (tenantSlugs.length === 0) {
          setTenants([]);
          return;
        }

        // Step 2: Fetch detail for each tenant
        const tenantDetails = await Promise.all(
          tenantSlugs.map(async (item) => {
            try {
              const detailRes = await fetch(
                `${API_URL}/tenants/by-slug/${item.slug}`
              );
              if (!detailRes.ok) return null;
              return await detailRes.json();
            } catch {
              return null;
            }
          })
        );

        // Step 3: Filter out failed fetches and add URLs
        const validTenants: ShowcaseTenant[] = tenantDetails
          .filter((t): t is TenantDetail => t !== null && t.id)
          .map((t) => ({
            ...t,
            url: getTenantFullUrl(t.slug),
          }));

        setTenants(validTenants);
      } catch (err) {
        console.error('Error fetching tenants:', err);
        setError('Gagal memuat data toko');
      } finally {
        setLoading(false);
      }
    }

    fetchTenants();
  }, []);

  // Don't render if no tenants and not loading
  if (!loading && tenants.length === 0 && !error) {
    return null;
  }

  return (
    <section className="py-20 md:py-32 bg-muted/30">
      <div className="container mx-auto px-4">
        {/* Header */}
        <div className="text-center mb-12">
          <Badge
            variant="secondary"
            className="mb-4 px-4 py-2 text-sm font-medium gap-2"
          >
            <Store className="h-4 w-4 text-primary" />
            <span>UMKM Showcase</span>
          </Badge>
          <h2 className="text-3xl md:text-4xl font-bold mb-4">
            Toko yang Sudah <span className="text-primary">Bergabung</span>
          </h2>
          <p className="text-lg text-muted-foreground max-w-2xl mx-auto">
            Lihat berbagai UMKM yang sudah punya alamat sendiri di Fibidy
          </p>
        </div>

        {/* Loading State */}
        {loading && (
          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
            {Array.from({ length: 8 }).map((_, i) => (
              <TenantCardSkeleton key={i} />
            ))}
          </div>
        )}

        {/* Error State */}
        {error && !loading && (
          <div className="text-center py-12">
            <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mb-4">
              <AlertCircle className="h-8 w-8 text-destructive" />
            </div>
            <p className="text-muted-foreground mb-4">{error}</p>
            <Button
              variant="outline"
              onClick={() => window.location.reload()}
            >
              Coba Lagi
            </Button>
          </div>
        )}

        {/* Tenant Grid */}
        {!loading && !error && tenants.length > 0 && (
          <>
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
              {tenants.map((tenant) => (
                <TenantCard key={tenant.id} tenant={tenant} />
              ))}
            </div>

            {/* CTA */}
            <div className="text-center mt-12">
              <p className="text-muted-foreground mb-4">
                Mau toko kamu juga tampil di sini?
              </p>
              <Button asChild size="lg">
                <Link href="/register">
                  Buat Toko Sekarang
                  <ArrowRight className="ml-2 h-4 w-4" />
                </Link>
              </Button>
            </div>
          </>
        )}
      </div>
    </section>
  );
}


================================================
FILE: src/components/discover/umkm-discover-section.tsx
Lines: 460
================================================

// ══════════════════════════════════════════════════════════════
// UMKM DISCOVER SECTION
// Dribbble/Behance Style Showcase
// ══════════════════════════════════════════════════════════════

'use client';

import { useEffect, useState } from 'react';
import Link from 'next/link';
import Image from 'next/image';
import {
  Store,
  Package,
  ArrowRight,
  AlertCircle,
  Search,
  Sparkles,
} from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Input } from '@/components/ui/input';
import { Skeleton } from '@/components/ui/skeleton';
import { getTenantFullUrl } from '@/lib/store-url';
import { cn } from '@/lib/cn';

// ══════════════════════════════════════════════════════════════
// TYPES
// ══════════════════════════════════════════════════════════════

interface TenantSitemapItem {
  slug: string;
  updatedAt: string;
}

interface TenantDetail {
  id: string;
  slug: string;
  name: string;
  category: string;
  description: string | null;
  logo: string | null;
  banner: string | null;
  _count?: {
    products: number;
  };
}

interface ShowcaseTenant extends TenantDetail {
  url: string;
}

// ══════════════════════════════════════════════════════════════
// CONSTANTS
// ══════════════════════════════════════════════════════════════

const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';
const MAX_TENANTS = 24;

const CATEGORY_LABELS: Record<string, string> = {
  'WARUNG_KELONTONG': 'Warung Kelontong',
  'TOKO_BANGUNAN': 'Toko Bangunan',
  'TOKO_ELEKTRONIK': 'Elektronik',
  'BENGKEL': 'Bengkel',
  'SALON_KECANTIKAN': 'Salon',
  'LAUNDRY': 'Laundry',
  'WARUNG_MAKAN': 'Warung Makan',
  'CATERING': 'Catering',
  'KEDAI_KOPI': 'Kedai Kopi',
  'TOKO_KUE': 'Bakery',
  'APOTEK': 'Apotek',
  'KONTER_HP': 'Konter HP',
  'RENTAL_KENDARAAN': 'Rental',
  'STUDIO_FOTO': 'Studio Foto',
  'PRINTING': 'Printing',
  'PET_SHOP': 'Pet Shop',
  'AC_SERVICE': 'Service AC',
  'RESTORAN': 'Restoran',
  'OTHER': 'Lainnya',
};

// ══════════════════════════════════════════════════════════════
// HELPER FUNCTIONS
// ══════════════════════════════════════════════════════════════

function getCategoryLabel(category: string): string {
  return CATEGORY_LABELS[category] || category;
}

function getInitials(name?: string | null): string {
  if (!name) return '??';
  return name
    .split(' ')
    .map((word) => word[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
}

// ══════════════════════════════════════════════════════════════
// SKELETON LOADER - Dribbble Style
// ══════════════════════════════════════════════════════════════

function TenantCardSkeleton() {
  return (
    <div className="group">
      {/* Image Container */}
      <Skeleton className="aspect-[4/3] w-full rounded-xl" />

      {/* Footer */}
      <div className="flex items-center gap-3 mt-3 px-1">
        <Skeleton className="h-8 w-8 rounded-full shrink-0" />
        <div className="flex-1 min-w-0">
          <Skeleton className="h-4 w-3/4" />
        </div>
        <Skeleton className="h-4 w-12" />
      </div>
    </div>
  );
}

// ══════════════════════════════════════════════════════════════
// TENANT CARD - Dribbble Style
// ══════════════════════════════════════════════════════════════

interface TenantCardProps {
  tenant: ShowcaseTenant;
}

function TenantCard({ tenant }: TenantCardProps) {
  const productCount = tenant._count?.products || 0;

  return (
    <Link
      href={tenant.url}
      target="_blank"
      rel="noopener noreferrer"
      className="group block"
    >
      {/* Image Container - Dribbble Style */}
      <div className="relative aspect-[4/3] w-full rounded-xl overflow-hidden bg-muted">
        {/* Banner Image */}
        {tenant.banner ? (
          <Image
            src={tenant.banner}
            alt={tenant.name || 'Store'}
            fill
            className="object-cover transition-transform duration-500 group-hover:scale-105"
          />
        ) : (
          <div className="absolute inset-0 bg-gradient-to-br from-primary/20 via-primary/10 to-pink-500/20 flex items-center justify-center">
            <Store className="h-12 w-12 text-primary/40" />
          </div>
        )}

        {/* Hover Overlay - Info slides up */}
        <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300">
          {/* Content at bottom */}
          <div className="absolute bottom-0 left-0 right-0 p-4 translate-y-2 group-hover:translate-y-0 transition-transform duration-300">
            {/* Description */}
            {tenant.description && (
              <p className="text-white/90 text-sm line-clamp-2 mb-3">
                {tenant.description}
              </p>
            )}

            {/* Stats Row */}
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Badge variant="secondary" className="bg-white/20 text-white border-0 text-xs">
                  {getCategoryLabel(tenant.category)}
                </Badge>
              </div>
              <div className="flex items-center gap-1.5 text-white/80 text-sm">
                <Package className="h-3.5 w-3.5" />
                <span>{productCount} produk</span>
              </div>
            </div>
          </div>
        </div>

        {/* Corner Badge - Always visible */}
        <div className="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
          <div className="bg-white rounded-full p-2 shadow-lg">
            <ArrowRight className="h-4 w-4 text-primary" />
          </div>
        </div>
      </div>

      {/* Footer - Avatar & Name (Dribbble style) */}
      <div className="flex items-center gap-3 mt-3 px-1">
        {/* Avatar */}
        <div className="h-8 w-8 rounded-full bg-muted flex items-center justify-center overflow-hidden shrink-0 ring-2 ring-background">
          {tenant.logo ? (
            <Image
              src={tenant.logo}
              alt={tenant.name || 'Logo'}
              width={32}
              height={32}
              className="object-cover"
            />
          ) : (
            <span className="text-xs font-bold text-muted-foreground">
              {getInitials(tenant.name)}
            </span>
          )}
        </div>

        {/* Name */}
        <h3 className="font-medium text-sm text-foreground truncate flex-1 group-hover:text-primary transition-colors">
          {tenant.name || 'Unnamed Store'}
        </h3>

        {/* Product Count - subtle */}
        <span className="text-xs text-muted-foreground shrink-0">
          {productCount} items
        </span>
      </div>
    </Link>
  );
}

// ══════════════════════════════════════════════════════════════
// MAIN COMPONENT
// ══════════════════════════════════════════════════════════════

export function UMKMDiscoverSection() {
  const [tenants, setTenants] = useState<ShowcaseTenant[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [searchQuery, setSearchQuery] = useState('');

  // Fetch tenants
  useEffect(() => {
    async function fetchTenants() {
      try {
        setLoading(true);
        setError(null);

        // Step 1: Get tenant slugs
        const sitemapRes = await fetch(
          `${API_URL}/sitemap/tenants/paginated?page=1&limit=${MAX_TENANTS}`
        );

        if (!sitemapRes.ok) {
          throw new Error('Failed to fetch tenant list');
        }

        const sitemapData = await sitemapRes.json();
        const tenantSlugs: TenantSitemapItem[] = sitemapData.tenants || [];

        if (tenantSlugs.length === 0) {
          setTenants([]);
          return;
        }

        // Step 2: Fetch detail for each tenant
        const tenantDetails = await Promise.all(
          tenantSlugs.map(async (item) => {
            try {
              const detailRes = await fetch(
                `${API_URL}/tenants/by-slug/${item.slug}`
              );
              if (!detailRes.ok) return null;
              return await detailRes.json();
            } catch {
              return null;
            }
          })
        );

        // Step 3: Filter and add URLs
        const validTenants: ShowcaseTenant[] = tenantDetails
          .filter((t): t is TenantDetail => t !== null && t.id)
          .map((t) => ({
            ...t,
            url: getTenantFullUrl(t.slug),
          }));

        setTenants(validTenants);
      } catch (err) {
        console.error('Error fetching tenants:', err);
        setError('Gagal memuat data toko');
      } finally {
        setLoading(false);
      }
    }

    fetchTenants();
  }, []);

  // Filter tenants by search
  const filteredTenants = tenants.filter((tenant) => {
    if (!searchQuery) return true;
    const query = searchQuery.toLowerCase();
    return (
      tenant.name?.toLowerCase().includes(query) ||
      tenant.description?.toLowerCase().includes(query) ||
      tenant.category?.toLowerCase().includes(query)
    );
  });

  return (
    <section className="py-8 md:py-12">
      <div className="container mx-auto px-4">
        {/* ══════════════════════════════════════════════════════ */}
        {/* HEADER - Discover Style                               */}
        {/* ══════════════════════════════════════════════════════ */}
        <div className="mb-8 md:mb-12">
          {/* Title Row */}
          <div className="flex flex-col md:flex-row md:items-end md:justify-between gap-6 mb-8">
            <div>
              <div className="flex items-center gap-2 mb-3">
                <Sparkles className="h-5 w-5 text-primary" />
                <span className="text-sm font-medium text-primary">Discover</span>
              </div>
              <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold tracking-tight">
                Temukan UMKM
                <span className="text-primary"> Lokal</span>
              </h1>
              <p className="text-muted-foreground mt-2 text-lg">
                Jelajahi berbagai usaha lokal yang sudah online di Fibidy
              </p>
            </div>

            {/* Search */}
            <div className="w-full md:w-80">
              <div className="relative">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                <Input
                  type="text"
                  placeholder="Cari toko atau kategori..."
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  className="pl-10 h-11 rounded-full bg-muted/50 border-0 focus-visible:ring-primary"
                />
              </div>
            </div>
          </div>

          {/* Quick Stats */}
          {!loading && tenants.length > 0 && (
            <div className="flex items-center gap-6 text-sm text-muted-foreground">
              <span>{tenants.length} UMKM terdaftar</span>
              <span>•</span>
              <span>{tenants.reduce((acc, t) => acc + (t._count?.products || 0), 0)} total produk</span>
            </div>
          )}
        </div>

        {/* ══════════════════════════════════════════════════════ */}
        {/* CONTENT                                                */}
        {/* ══════════════════════════════════════════════════════ */}

        {/* Loading State */}
        {loading && (
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
            {Array.from({ length: 8 }).map((_, i) => (
              <TenantCardSkeleton key={i} />
            ))}
          </div>
        )}

        {/* Error State */}
        {error && !loading && (
          <div className="text-center py-20">
            <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-destructive/10 mb-4">
              <AlertCircle className="h-8 w-8 text-destructive" />
            </div>
            <p className="text-muted-foreground mb-4">{error}</p>
            <Button
              variant="outline"
              onClick={() => window.location.reload()}
            >
              Coba Lagi
            </Button>
          </div>
        )}

        {/* Empty State */}
        {!loading && !error && filteredTenants.length === 0 && (
          <div className="text-center py-20">
            <div className="inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4">
              <Store className="h-8 w-8 text-muted-foreground" />
            </div>
            <h3 className="font-semibold mb-2">
              {searchQuery ? 'Tidak ada hasil' : 'Belum ada toko'}
            </h3>
            <p className="text-muted-foreground mb-6">
              {searchQuery
                ? `Tidak ditemukan toko dengan kata kunci "${searchQuery}"`
                : 'Jadilah yang pertama membuat toko di Fibidy!'
              }
            </p>
            {searchQuery ? (
              <Button variant="outline" onClick={() => setSearchQuery('')}>
                Reset Pencarian
              </Button>
            ) : (
              <Button asChild>
                <Link href="/register">
                  Buat Toko Sekarang
                  <ArrowRight className="ml-2 h-4 w-4" />
                </Link>
              </Button>
            )}
          </div>
        )}

        {/* Tenant Grid - Dribbble Style */}
        {!loading && !error && filteredTenants.length > 0 && (
          <>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8">
              {filteredTenants.map((tenant) => (
                <TenantCard key={tenant.id} tenant={tenant} />
              ))}
            </div>

            {/* CTA Banner */}
            <div className="mt-16 md:mt-24">
              <div className="relative rounded-2xl overflow-hidden bg-gradient-to-r from-primary via-primary to-pink-500 p-8 md:p-12">
                {/* Pattern */}
                <div className="absolute inset-0 opacity-10">
                  <svg className="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                    <defs>
                      <pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse">
                        <circle cx="1" cy="1" r="1" fill="white" />
                      </pattern>
                    </defs>
                    <rect width="100" height="100" fill="url(#grid)" />
                  </svg>
                </div>

                <div className="relative flex flex-col md:flex-row md:items-center md:justify-between gap-6">
                  <div className="text-white">
                    <h3 className="text-2xl md:text-3xl font-bold mb-2">
                      Punya Usaha?
                    </h3>
                    <p className="text-white/80 text-lg">
                      Buat toko online kamu dan tampil di sini. Gratis!
                    </p>
                  </div>
                  <Button
                    asChild
                    size="lg"
                    variant="secondary"
                    className="bg-white text-primary hover:bg-white/90 shadow-lg shrink-0"
                  >
                    <Link href="/register">
                      Daftar Sekarang
                      <ArrowRight className="ml-2 h-4 w-4" />
                    </Link>
                  </Button>
                </div>
              </div>
            </div>
          </>
        )}
      </div>
    </section>
  );
}


================================================
FILE: src/lib/cn.ts
Lines: 9
================================================

import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';

/**
 * Merge Tailwind classes with clsx
 * Usage: cn('px-4 py-2', conditional && 'bg-primary', className)
 */
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}


================================================
FILE: src/lib/format.ts
Lines: 319
================================================

// ==========================================
// FORMAT UTILITIES - MERGED & UPDATED
// Support multi-currency & locale
// ==========================================

// ==========================================
// PRICE FORMATTING
// ==========================================

/**
 * Format price with currency (DEFAULT: IDR)
 * @param price - Price number
 * @param currency - Currency code (default: IDR)
 * @returns Formatted price string
 * @example formatPrice(15000) => "Rp 15.000"
 * @example formatPrice(100, 'USD') => "$100"
 */
export function formatPrice(price: number, currency: string = 'IDR'): string {
  return new Intl.NumberFormat('id-ID', {
    style: 'currency',
    currency: currency,
    minimumFractionDigits: 0,
    maximumFractionDigits: 0,
  }).format(price);
}

/**
 * Format price with custom locale
 * @param price - Price number
 * @param locale - Locale string (default: id-ID)
 * @param currency - Currency code (default: IDR)
 * @returns Formatted price string
 * @example formatPriceLocale(15000, 'en-US', 'USD') => "$15,000"
 */
export function formatPriceLocale(
  price: number,
  locale: string = 'id-ID',
  currency: string = 'IDR'
): string {
  return new Intl.NumberFormat(locale, {
    style: 'currency',
    currency,
    minimumFractionDigits: 0,
    maximumFractionDigits: 0,
  }).format(price);
}

/**
 * Format price to short format (Rp 1.5jt, Rp 2M)
 * @param price - Price number
 * @returns Short formatted price string
 * @example formatPriceShort(1500000) => "Rp 1.5jt"
 * @example formatPriceShort(2000000000) => "Rp 2.0M"
 */
export function formatPriceShort(price: number): string {
  if (price >= 1000000000) {
    return `Rp ${(price / 1000000000).toFixed(1)}M`;
  }
  if (price >= 1000000) {
    return `Rp ${(price / 1000000).toFixed(1)}jt`;
  }
  if (price >= 1000) {
    return `Rp ${(price / 1000).toFixed(0)}rb`;
  }
  return `Rp ${price}`;
}

// ==========================================
// NUMBER FORMATTING
// ==========================================

/**
 * Format number with thousand separator
 * @param num - Number to format
 * @returns Formatted number string
 * @example formatNumber(1500000) => "1.500.000"
 */
export function formatNumber(num: number): string {
  return new Intl.NumberFormat('id-ID').format(num);
}

/**
 * Format percentage
 * @param value - Percentage value
 * @param decimals - Decimal places (default: 0)
 * @returns Formatted percentage string
 * @example formatPercentage(15.5, 1) => "15.5%"
 * @example formatPercentage(20) => "20%"
 */
export function formatPercentage(value: number, decimals: number = 0): string {
  return `${value.toFixed(decimals)}%`;
}

// ==========================================
// DATE & TIME FORMATTING
// ==========================================

/**
 * Format date to Indonesian format
 * @param date - Date string or Date object
 * @returns Formatted date string
 * @example formatDate('2024-01-15') => "15 Januari 2024"
 */
export function formatDate(date: string | Date): string {
  return new Intl.DateTimeFormat('id-ID', {
    day: 'numeric',
    month: 'long',
    year: 'numeric',
  }).format(new Date(date));
}

/**
 * Format date to short format
 * @param date - Date string or Date object
 * @returns Short formatted date string
 * @example formatDateShort('2024-01-15') => "15 Jan 2024"
 */
export function formatDateShort(date: string | Date): string {
  return new Intl.DateTimeFormat('id-ID', {
    day: 'numeric',
    month: 'short',
    year: 'numeric',
  }).format(new Date(date));
}

/**
 * Format datetime with time
 * @param date - Date string or Date object
 * @returns Formatted datetime string
 * @example formatDateTime('2024-01-15T10:30') => "15 Jan 2024, 10:30"
 */
export function formatDateTime(date: string | Date): string {
  return new Intl.DateTimeFormat('id-ID', {
    day: 'numeric',
    month: 'short',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
  }).format(new Date(date));
}

/**
 * Format relative time (e.g., "5 menit lalu")
 * @param date - Date string or Date object
 * @returns Relative time string
 * @example formatRelativeTime(Date.now() - 300000) => "5 menit lalu"
 */
export function formatRelativeTime(date: string | Date): string {
  const now = new Date();
  const then = new Date(date);
  const diffMs = now.getTime() - then.getTime();
  const diffMins = Math.floor(diffMs / 60000);
  const diffHours = Math.floor(diffMins / 60);
  const diffDays = Math.floor(diffHours / 24);

  if (diffMins < 1) return 'Baru saja';
  if (diffMins < 60) return `${diffMins} menit lalu`;
  if (diffHours < 24) return `${diffHours} jam lalu`;
  if (diffDays < 7) return `${diffDays} hari lalu`;
  return formatDateShort(date);
}

// ==========================================
// PHONE NUMBER FORMATTING
// ==========================================

/**
 * Format phone number for display
 * @param phone - Phone number string
 * @returns Formatted phone string
 * @example formatPhone('6281234567890') => "+62 812-3456-7890"
 */
export function formatPhone(phone: string): string {
  const cleaned = phone.replace(/\D/g, '');
  if (cleaned.startsWith('62')) {
    const number = cleaned.slice(2);
    return `+62 ${number.slice(0, 3)}-${number.slice(3, 7)}-${number.slice(7)}`;
  }
  return phone;
}

/**
 * Normalize phone number to 62xxx format
 * @param phone - Phone number string
 * @returns Normalized phone string (62xxx)
 * @example normalizePhone('081234567890') => "6281234567890"
 * @example normalizePhone('6281234567890') => "6281234567890"
 */
export function normalizePhone(phone: string): string {
  let cleaned = phone.replace(/\D/g, '');
  if (cleaned.startsWith('0')) {
    cleaned = '62' + cleaned.slice(1);
  }
  if (!cleaned.startsWith('62')) {
    cleaned = '62' + cleaned;
  }
  return cleaned;
}

// ==========================================
// WHATSAPP UTILITIES
// ==========================================

/**
 * Generate WhatsApp link with message
 * @param phone - Phone number (will be auto-normalized)
 * @param message - Message to send
 * @returns WhatsApp URL
 * @example generateWhatsAppLink('081234567890', 'Hello') => "https://wa.me/6281234567890?text=Hello"
 */
export function generateWhatsAppLink(phone: string, message: string): string {
  const cleanPhone = phone.replace(/\D/g, '');
  const encodedMessage = encodeURIComponent(message);
  return `https://wa.me/${cleanPhone}?text=${encodedMessage}`;
}

/**
 * Generate order WhatsApp message
 * @param storeName - Store name
 * @param products - Array of products with name, qty, price
 * @returns Formatted WhatsApp message
 */
export function generateOrderWhatsAppMessage(
  storeName: string,
  products: Array<{ name: string; qty: number; price: number }>
): string {
  const itemsList = products
    .map((p) => `• ${p.name} (${p.qty}x) - ${formatPrice(p.price * p.qty)}`)
    .join('\n');

  const total = products.reduce((sum, p) => sum + p.price * p.qty, 0);

  return `Halo ${storeName},

Saya ingin memesan:
${itemsList}

Total: ${formatPrice(total)}

Mohon konfirmasi ketersediaan.
Terima kasih!`;
}

// ==========================================
// TEXT UTILITIES
// ==========================================

/**
 * Slugify text (URL-safe)
 * @param text - Text to slugify
 * @returns Slugified string
 * @example slugify('Hello World 123') => "hello-world-123"
 */
export function slugify(text: string): string {
  return text
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/(^-|-$)/g, '');
}

/**
 * Get initials from name
 * @param name - Full name
 * @returns Initials (max 2 chars)
 * @example getInitials('John Doe') => "JD"
 */
export function getInitials(name: string): string {
  return name
    .split(' ')
    .map((n) => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
}

/**
 * Truncate text with ellipsis
 * @param text - Text to truncate
 * @param length - Max length
 * @returns Truncated string
 * @example truncate('Hello World', 8) => "Hello Wo..."
 */
export function truncate(text: string, length: number): string {
  if (text.length <= length) return text;
  return text.slice(0, length) + '...';
}

// ==========================================
// STATUS COLOR UTILITIES
// ==========================================

/**
 * Get order status color class (Tailwind)
 * @param status - Order status
 * @returns Tailwind color classes
 */
export function getOrderStatusColor(status: string): string {
  const colors: Record<string, string> = {
    PENDING: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300',
    PROCESSING: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300',
    COMPLETED: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300',
    CANCELLED: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300',
  };
  return colors[status] || 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300';
}

/**
 * Get payment status color class (Tailwind)
 * @param status - Payment status
 * @returns Tailwind color classes
 */
export function getPaymentStatusColor(status: string): string {
  const colors: Record<string, string> = {
    PENDING: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300',
    PAID: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300',
    PARTIAL: 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300',
    FAILED: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300',
  };
  return colors[status] || 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300';
}


================================================
FILE: src/lib/store-url.ts
Lines: 284
================================================

// ==========================================
// STORE URL HELPER (CLIENT-SIDE)
// src/lib/store-url.ts
//
// Smart path generation for internal navigation:
// - Development (localhost): /store/{slug}/products
// - Production (subdomain): /products
//
// + NEW: getTenantFullUrl for external links
// ==========================================

'use client';

import { useMemo } from 'react';

// ==========================================
// CONSTANTS
// ==========================================

const ROOT_DOMAIN = process.env.NEXT_PUBLIC_ROOT_DOMAIN || 'fibidy.com';

// ==========================================
// ENVIRONMENT DETECTION
// ==========================================

/**
 * Check if currently running on subdomain
 * Returns true ONLY when on {slug}.fibidy.com
 */
export function isSubdomainRouting(): boolean {
  // Server-side: can't detect, assume based on NODE_ENV
  if (typeof window === 'undefined') {
    return process.env.NODE_ENV === 'production';
  }

  const hostname = window.location.hostname;

  // Localhost = path-based routing
  if (hostname === 'localhost' || hostname === '127.0.0.1') {
    return false;
  }

  // Vercel preview = path-based routing
  if (hostname.includes('.vercel.app')) {
    return false;
  }

  // Main domain (fibidy.com, www.fibidy.com) = path-based routing
  if (hostname === ROOT_DOMAIN || hostname === `www.${ROOT_DOMAIN}`) {
    return false;
  }

  // Subdomain (xxx.fibidy.com) = subdomain routing!
  if (hostname.endsWith(`.${ROOT_DOMAIN}`)) {
    return true;
  }

  return false;
}

/**
 * Check if currently in development/localhost
 */
export function isLocalhost(): boolean {
  if (typeof window === 'undefined') {
    return process.env.NODE_ENV === 'development';
  }

  const hostname = window.location.hostname;
  return hostname === 'localhost' || hostname === '127.0.0.1';
}

// ==========================================
// FULL URL GENERATOR (NEW!)
// For external links / showcase cards
// ==========================================

/**
 * Get full tenant URL (for external navigation)
 * 
 * @example
 * // On localhost:
 * getTenantFullUrl('warung-busari') → '/store/warung-busari'
 * 
 * // On production (fibidy.com):
 * getTenantFullUrl('warung-busari') → 'https://warung-busari.fibidy.com'
 * 
 * // With path:
 * getTenantFullUrl('warung-busari', '/products') → 'https://warung-busari.fibidy.com/products'
 */
export function getTenantFullUrl(slug: string, path: string = '/'): string {
  // Normalize path
  const normalizedPath = path === '/' ? '' : path.startsWith('/') ? path : `/${path}`;

  // Server-side detection
  if (typeof window === 'undefined') {
    if (process.env.NODE_ENV === 'production') {
      return `https://${slug}.${ROOT_DOMAIN}${normalizedPath}`;
    }
    return `/store/${slug}${normalizedPath}`;
  }

  const hostname = window.location.hostname;

  // Localhost = path-based
  if (hostname === 'localhost' || hostname === '127.0.0.1') {
    const fullPath = `/store/${slug}${normalizedPath}`;
    return fullPath || `/store/${slug}`;
  }

  // Vercel preview = path-based
  if (hostname.includes('.vercel.app')) {
    const fullPath = `/store/${slug}${normalizedPath}`;
    return fullPath || `/store/${slug}`;
  }

  // Production = subdomain
  return `https://${slug}.${ROOT_DOMAIN}${normalizedPath}`;
}

/**
 * Get tenant home URL (shorthand)
 */
export function getTenantHomeUrl(slug: string): string {
  return getTenantFullUrl(slug, '/');
}

// ==========================================
// PATH GENERATORS (Internal Navigation)
// ==========================================

/**
 * Get store base path
 * - Subdomain: "" (empty)
 * - Path-based: "/store/{slug}"
 */
export function getStoreBasePath(storeSlug: string): string {
  if (isSubdomainRouting()) {
    return ''; // No prefix needed on subdomain
  }
  return `/store/${storeSlug}`;
}

/**
 * Generate store internal path
 *
 * @example
 * // On localhost:
 * storeUrl('warung', '/products') → '/store/warung/products'
 * storeUrl('warung', '/') → '/store/warung'
 *
 * // On warung.fibidy.com:
 * storeUrl('warung', '/products') → '/products'
 * storeUrl('warung', '/') → '/'
 */
export function storeUrl(storeSlug: string, path: string = '/'): string {
  const basePath = getStoreBasePath(storeSlug);

  // Normalize path
  const normalizedPath = path === '/' ? '' : path.startsWith('/') ? path : `/${path}`;

  // Combine base + path
  const fullPath = `${basePath}${normalizedPath}`;

  // Return '/' if empty
  return fullPath || '/';
}

/**
 * Generate product detail URL
 *
 * @example
 * productUrl('warung', 'abc123')
 * // localhost → '/store/warung/products/abc123'
 * // subdomain → '/products/abc123'
 */
export function productUrl(storeSlug: string, productId: string): string {
  return storeUrl(storeSlug, `/products/${productId}`);
}

/**
 * Generate products list URL with query params
 *
 * @example
 * productsUrl('warung', { category: 'makanan', page: '2' })
 * // localhost → '/store/warung/products?category=makanan&page=2'
 * // subdomain → '/products?category=makanan&page=2'
 */
export function productsUrl(
  storeSlug: string,
  params?: Record<string, string | undefined>
): string {
  const base = storeUrl(storeSlug, '/products');

  if (!params) return base;

  // Filter out undefined values
  const filteredParams: Record<string, string> = {};
  Object.entries(params).forEach(([key, value]) => {
    if (value !== undefined && value !== '') {
      filteredParams[key] = value;
    }
  });

  if (Object.keys(filteredParams).length === 0) return base;

  const searchParams = new URLSearchParams(filteredParams);
  return `${base}?${searchParams.toString()}`;
}

// ==========================================
// REACT HOOKS
// ==========================================

/**
 * Hook untuk generate store URLs (internal navigation)
 * Memoized untuk performance
 *
 * @example
 * const urls = useStoreUrls('warung');
 *
 * <Link href={urls.home}>Home</Link>
 * <Link href={urls.products()}>All Products</Link>
 * <Link href={urls.products({ category: 'food' })}>Food</Link>
 * <Link href={urls.product('abc123')}>Product Detail</Link>
 */
export function useStoreUrls(storeSlug: string) {
  return useMemo(
    () => ({
      /** Store home: "/" or "/store/{slug}" */
      home: storeUrl(storeSlug, '/'),

      /** Products list with optional params */
      products: (params?: Record<string, string | undefined>) =>
        productsUrl(storeSlug, params),

      /** Single product detail */
      product: (productId: string) => productUrl(storeSlug, productId),

      /** Generic path */
      path: (path: string) => storeUrl(storeSlug, path),
    }),
    [storeSlug]
  );
}

/**
 * Hook untuk generate tenant full URL (external navigation)
 * Useful for showcase cards, sharing, etc.
 *
 * @example
 * const tenantUrl = useTenantFullUrl('warung-busari');
 * // localhost → '/store/warung-busari'
 * // production → 'https://warung-busari.fibidy.com'
 */
export function useTenantFullUrl(slug: string) {
  return useMemo(() => getTenantFullUrl(slug), [slug]);
}

// ==========================================
// DEBUG HELPER
// ==========================================

/**
 * Debug: Log current routing mode
 * Call this in console to check: window.__debugStoreUrl()
 */
if (typeof window !== 'undefined') {
  (window as unknown as Record<string, unknown>).__debugStoreUrl = () => {
    const hostname = window.location.hostname;
    const isSubdomain = isSubdomainRouting();
    const isLocal = isLocalhost();
    console.log({
      hostname,
      isSubdomain,
      isLocal,
      rootDomain: ROOT_DOMAIN,
      exampleHome: storeUrl('test', '/'),
      exampleProducts: storeUrl('test', '/products'),
      exampleProduct: productUrl('test', 'abc123'),
      exampleFullUrl: getTenantFullUrl('test'),
      exampleFullUrlWithPath: getTenantFullUrl('test', '/products'),
    });
  };
}


================================================
FILE: src/config/categories.ts
Lines: 441
================================================

import {
  ShoppingCart,
  Wrench,
  Scissors,
  Shirt,
  UtensilsCrossed,
  Package,
  Coffee,
  Cake,
  Pill,
  Wind,
  Camera,
  Dog,
  Dumbbell,
  Home,
  Printer,
  type LucideIcon,
} from 'lucide-react';

// ==========================================
// CATEGORY TYPES
// ==========================================

export interface CategoryFeatures {
  stock: boolean;
  debt: boolean;
  booking: boolean;
  tracking: boolean;
  membership: boolean;
  cashier: boolean;
}

export interface CategoryLabels {
  product: string;
  price: string;
  customer: string;
}

export interface CategoryConfig {
  key: string;
  icon: LucideIcon;
  label: string;
  labelShort: string;
  color: string;
  description: string;
  features: CategoryFeatures;
  labels: CategoryLabels;
}

// ==========================================
// 15 MVP CATEGORIES
// ==========================================

export const CATEGORY_CONFIG: Record<string, CategoryConfig> = {
  // ========== RETAIL ==========
  WARUNG_KELONTONG: {
    key: 'WARUNG_KELONTONG',
    icon: ShoppingCart,
    label: 'Warung Kelontong',
    labelShort: 'Warung',
    color: '#10b981',
    description: 'Toko kelontong, sembako, minimarket',
    features: {
      stock: true,
      debt: true,
      booking: false,
      tracking: false,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Produk',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  TOKO_BANGUNAN: {
    key: 'TOKO_BANGUNAN',
    icon: Package,
    label: 'Toko Bangunan',
    labelShort: 'Bangunan',
    color: '#f59e0b',
    description: 'Material bangunan, alat tukang',
    features: {
      stock: true,
      debt: true,
      booking: false,
      tracking: false,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Material',
      price: 'Harga',
      customer: 'Kontraktor',
    },
  },

  // ========== SERVICE ==========
  BENGKEL_MOTOR: {
    key: 'BENGKEL_MOTOR',
    icon: Wrench,
    label: 'Bengkel Motor',
    labelShort: 'Bengkel',
    color: '#f97316',
    description: 'Service motor, ganti oli, tune up',
    features: {
      stock: true,
      debt: false,
      booking: true,
      tracking: true,
      membership: false,
      cashier: false,
    },
    labels: {
      product: 'Layanan',
      price: 'Tarif',
      customer: 'Pelanggan',
    },
  },

  LAUNDRY: {
    key: 'LAUNDRY',
    icon: Shirt,
    label: 'Laundry',
    labelShort: 'Laundry',
    color: '#3b82f6',
    description: 'Cuci kiloan, cuci satuan, setrika',
    features: {
      stock: false,
      debt: false,
      booking: false,
      tracking: true,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Layanan',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  SERVICE_AC: {
    key: 'SERVICE_AC',
    icon: Wind,
    label: 'Service AC',
    labelShort: 'AC',
    color: '#06b6d4',
    description: 'Service AC, elektronik, kulkas',
    features: {
      stock: true,
      debt: false,
      booking: true,
      tracking: true,
      membership: false,
      cashier: false,
    },
    labels: {
      product: 'Layanan',
      price: 'Tarif',
      customer: 'Pelanggan',
    },
  },

  // ========== BEAUTY & HEALTH ==========
  SALON_BARBERSHOP: {
    key: 'SALON_BARBERSHOP',
    icon: Scissors,
    label: 'Salon & Barbershop',
    labelShort: 'Salon',
    color: '#ec4899',
    description: 'Potong rambut, creambath, facial',
    features: {
      stock: false,
      debt: false,
      booking: true,
      tracking: false,
      membership: true,
      cashier: true,
    },
    labels: {
      product: 'Layanan',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  APOTEK: {
    key: 'APOTEK',
    icon: Pill,
    label: 'Apotek',
    labelShort: 'Apotek',
    color: '#ef4444',
    description: 'Obat, vitamin, alat kesehatan',
    features: {
      stock: true,
      debt: false,
      booking: false,
      tracking: false,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Obat',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  // ========== F&B ==========
  CATERING: {
    key: 'CATERING',
    icon: UtensilsCrossed,
    label: 'Catering',
    labelShort: 'Catering',
    color: '#f59e0b',
    description: 'Catering harian, prasmanan, nasi box',
    features: {
      stock: false,
      debt: false,
      booking: true,
      tracking: true,
      membership: false,
      cashier: false,
    },
    labels: {
      product: 'Menu',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  KEDAI_KOPI: {
    key: 'KEDAI_KOPI',
    icon: Coffee,
    label: 'Kedai Kopi',
    labelShort: 'Kopi',
    color: '#78350f',
    description: 'Coffee shop, cafe, kedai minuman',
    features: {
      stock: true,
      debt: false,
      booking: false,
      tracking: false,
      membership: true,
      cashier: true,
    },
    labels: {
      product: 'Menu',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  TOKO_KUE: {
    key: 'TOKO_KUE',
    icon: Cake,
    label: 'Toko Kue',
    labelShort: 'Kue',
    color: '#db2777',
    description: 'Kue, roti, bakery, pastry',
    features: {
      stock: true,
      debt: false,
      booking: true,
      tracking: false,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Produk',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },

  // ========== OTHERS ==========
  FOTOGRAFI: {
    key: 'FOTOGRAFI',
    icon: Camera,
    label: 'Fotografi',
    labelShort: 'Foto',
    color: '#8b5cf6',
    description: 'Studio foto, wedding, dokumentasi',
    features: {
      stock: false,
      debt: false,
      booking: true,
      tracking: true,
      membership: false,
      cashier: false,
    },
    labels: {
      product: 'Paket',
      price: 'Harga',
      customer: 'Klien',
    },
  },

  PETSHOP: {
    key: 'PETSHOP',
    icon: Dog,
    label: 'Pet Shop',
    labelShort: 'Pet',
    color: '#f97316',
    description: 'Makanan hewan, grooming, aksesoris',
    features: {
      stock: true,
      debt: false,
      booking: true,
      tracking: false,
      membership: true,
      cashier: true,
    },
    labels: {
      product: 'Produk',
      price: 'Harga',
      customer: 'Pet Owner',
    },
  },

  GYM_FITNESS: {
    key: 'GYM_FITNESS',
    icon: Dumbbell,
    label: 'Gym & Fitness',
    labelShort: 'Gym',
    color: '#059669',
    description: 'Tempat gym, fitness center',
    features: {
      stock: false,
      debt: false,
      booking: true,
      tracking: false,
      membership: true,
      cashier: true,
    },
    labels: {
      product: 'Paket',
      price: 'Harga',
      customer: 'Member',
    },
  },

  KOST_KONTRAKAN: {
    key: 'KOST_KONTRAKAN',
    icon: Home,
    label: 'Kost & Kontrakan',
    labelShort: 'Kost',
    color: '#0891b2',
    description: 'Kost, kontrakan, sewa kamar',
    features: {
      stock: false,
      debt: true,
      booking: true,
      tracking: true,
      membership: false,
      cashier: false,
    },
    labels: {
      product: 'Kamar',
      price: 'Harga',
      customer: 'Penghuni',
    },
  },

  PERCETAKAN: {
    key: 'PERCETAKAN',
    icon: Printer,
    label: 'Percetakan',
    labelShort: 'Print',
    color: '#4f46e5',
    description: 'Print, fotocopy, cetak undangan',
    features: {
      stock: true,
      debt: false,
      booking: true,
      tracking: true,
      membership: false,
      cashier: true,
    },
    labels: {
      product: 'Layanan',
      price: 'Harga',
      customer: 'Pelanggan',
    },
  },
};

// ==========================================
// HELPER FUNCTIONS
// ==========================================

/**
 * Get category config by key
 */
export function getCategoryConfig(category: string): CategoryConfig | null {
  return CATEGORY_CONFIG[category] || null;
}

/**
 * Get all categories as array
 */
export function getCategoryList(): CategoryConfig[] {
  return Object.values(CATEGORY_CONFIG);
}

/**
 * Get category options for select
 */
export function getCategoryOptions(): { value: string; label: string }[] {
  return Object.values(CATEGORY_CONFIG).map((cat) => ({
    value: cat.key,
    label: cat.label,
  }));
}

/**
 * Default category config for unknown categories
 */
export const DEFAULT_CATEGORY_CONFIG: CategoryConfig = {
  key: 'OTHER',
  icon: Package,
  label: 'Lainnya',
  labelShort: 'Lainnya',
  color: '#6b7280',
  description: 'Kategori lainnya',
  features: {
    stock: true,
    debt: false,
    booking: false,
    tracking: false,
    membership: false,
    cashier: true,
  },
  labels: {
    product: 'Produk',
    price: 'Harga',
    customer: 'Pelanggan',
  },
};


================================================================
COLLECTION SUMMARY
================================================================

📦 Discover Module (V2 - Isolated):
   📄 Pages: 5 files
   🎨 Components: 10 files (src/components/discover/)
   🔧 Lib/Config: 4 files
   ─────────────────
   📁 Total: 19 files
   
📝 Stats:
   ✅ Found: 19 files
   ❌ Missing: 0 files
   📝 Total lines: 5678

📍 Output: /d/PRODUK-LPPM-FINAL/UMKM-MULTI-TENANT/client/collections/discover-module-20260116-162623.txt

================================================================
END OF COLLECTION
================================================================
